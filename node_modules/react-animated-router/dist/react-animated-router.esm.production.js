import t,{Component as n}from"react";import{findDOMNode as e}from"react-dom";import{TransitionGroup as r,CSSTransition as o}from"react-transition-group";import{withRouter as i,Switch as a}from"react-router";function s(t,n){if(!(t instanceof n)){throw new TypeError("Cannot call a class as a function")}}function u(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(t,r.key,r)}}function f(t,n,e){if(n)u(t.prototype,n);if(e)u(t,e);return t}function c(t){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){c=function t(n){return typeof n}}else{c=function t(n){return n&&typeof Symbol==="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n}}return c(t)}function l(t){if(typeof Symbol==="function"&&c(Symbol.iterator)==="symbol"){l=function t(n){return c(n)}}else{l=function t(n){return n&&typeof Symbol==="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":c(n)}}return l(t)}function p(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function y(t,n){if(n&&(l(n)==="object"||typeof n==="function")){return n}return p(t)}function m(t){m=Object.setPrototypeOf?Object.getPrototypeOf:function t(n){return n.__proto__||Object.getPrototypeOf(n)};return m(t)}function d(t,n){d=Object.setPrototypeOf||function t(n,e){n.__proto__=e;return n};return d(t,n)}function b(t,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:true,configurable:true}});if(n)d(t,n)}var h=typeof window==="undefined";var v={key:"",isPush:true};var E="REACT_HISTORIES_KEY";var T=h?[]:(sessionStorage.getItem(E)||"").split(",").filter(Boolean);var g=function t(n,e){if(h){return true}var r=n.key||n.pathname+n.search;if(e&&r!==v.key){var o=T.lastIndexOf(r);if(o>-1){T.splice(o+1)}else{T.push(r)}sessionStorage.setItem(E,T.join(","));v={isPush:o<0,key:r}}return v.isPush};var w=function(n){b(i,n);function i(){var t;var n;s(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++){r[o]=arguments[o]}n=y(this,(t=m(i)).call.apply(t,[this].concat(r)));n.inTransition=false;n.rootNode=void 0;n.lastTransitionNode=void 0;n.onEnter=function(t){n.inTransition||n.setInTransition(n.inTransition=true);n.lastTransitionNode=t};n.onEntering=function(t){var e=n.props.timeout;if(t&&typeof e==="number"){t.style.transitionDuration=t.style.WebkitTransitionDuration=t.style.MozTransitionDuration=e+"ms"}};n.onEntered=function(t){if(n.lastTransitionNode===t){n.inTransition&&n.setInTransition(n.inTransition=false)}if(t){var e=n.props.timeout;t.className=t.className.split(/\s+/).filter(function(t){return!/-(?:forward|backward)-(?:enter|exit)(?:-active)?$/.test(t)}).join(" ");if(typeof e==="number"){t.style.transitionDuration=t.style.WebkitTransitionDuration=t.style.MozTransitionDuration=""}}};return n}f(i,[{key:"setInTransition",value:function t(n){if(this.rootNode){var e=this.props.prefix+"-in-transition";this.rootNode.className=this.rootNode.className.split(/\s+/).filter(function(t){return t!==e}).concat(n?e:[]).join(" ")}}},{key:"componentDidMount",value:function t(){this.rootNode=e(this)}},{key:"render",value:function n(){if(h){return t.createElement(a,null,this.props.children)}var e=this.props,i=e.className,s=e.location,u=e.children,f=e.timeout,c=e.prefix,l=e.appear,p=e.enter,y=e.exit,m=e.component;var d={appear:l,enter:p,exit:y,component:m};var b={onExit:this.onEnter,onExiting:this.onEntering,onExited:this.onEntered,onEnter:this.onEnter,onEntering:this.onEntering,onEntered:this.onEntered};var v=[c+"-container","react-animated-router",i];return t.createElement(r,Object.assign({className:v.filter(Boolean).join(" "),childFactory:function n(e){var r=c+"-"+(g(s,e.props.in)?"forward":"backward");return t.cloneElement(e,{classNames:r})}},d),t.createElement(o,Object.assign({key:this.props.transitionKey||s.pathname,addEndListener:function t(n,e){n.addEventListener("transitionend",function(t){if(t.target===n){e()}},false)},unmountOnExit:true,timeout:f},b),t.createElement(a,{location:s},u)))}}]);return i}(n);w.defaultProps={prefix:"animated-router"};var N=i(w);export default N;
