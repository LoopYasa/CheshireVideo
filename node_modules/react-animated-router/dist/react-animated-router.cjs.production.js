"use strict";Object.defineProperty(exports,"__esModule",{value:true});function t(t){return t&&typeof t==="object"&&"default"in t?t["default"]:t}var e=require("react");var n=t(e);var r=require("react-dom");var o=require("react-transition-group");var i=require("react-router");function a(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(t,r.key,r)}}function u(t,e,n){if(e)s(t.prototype,e);if(n)s(t,n);return t}function c(t){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){c=function t(e){return typeof e}}else{c=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return c(t)}function f(t){if(typeof Symbol==="function"&&c(Symbol.iterator)==="symbol"){f=function t(e){return c(e)}}else{f=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":c(e)}}return f(t)}function l(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function p(t,e){if(e&&(f(e)==="object"||typeof e==="function")){return e}return l(t)}function y(t){y=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return y(t)}function d(t,e){d=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return d(t,e)}function m(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)d(t,e)}var b=typeof window==="undefined";var h={key:"",isPush:true};var v="REACT_HISTORIES_KEY";var E=b?[]:(sessionStorage.getItem(v)||"").split(",").filter(Boolean);var T=function t(e,n){if(b){return true}var r=e.key||e.pathname+e.search;if(n&&r!==h.key){var o=E.lastIndexOf(r);if(o>-1){E.splice(o+1)}else{E.push(r)}sessionStorage.setItem(v,E.join(","));h={isPush:o<0,key:r}}return h.isPush};var S=function(t){m(e,t);function e(){var t;var n;a(this,e);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++){o[i]=arguments[i]}n=p(this,(t=y(e)).call.apply(t,[this].concat(o)));n.inTransition=false;n.rootNode=void 0;n.lastTransitionNode=void 0;n.onEnter=function(t){n.inTransition||n.setInTransition(n.inTransition=true);n.lastTransitionNode=t};n.onEntering=function(t){var e=n.props.timeout;if(t&&typeof e==="number"){t.style.transitionDuration=t.style.WebkitTransitionDuration=t.style.MozTransitionDuration=e+"ms"}};n.onEntered=function(t){if(n.lastTransitionNode===t){n.inTransition&&n.setInTransition(n.inTransition=false)}if(t){var e=n.props.timeout;t.className=t.className.split(/\s+/).filter(function(t){return!/-(?:forward|backward)-(?:enter|exit)(?:-active)?$/.test(t)}).join(" ");if(typeof e==="number"){t.style.transitionDuration=t.style.WebkitTransitionDuration=t.style.MozTransitionDuration=""}}};return n}u(e,[{key:"setInTransition",value:function t(e){if(this.rootNode){var n=this.props.prefix+"-in-transition";this.rootNode.className=this.rootNode.className.split(/\s+/).filter(function(t){return t!==n}).concat(e?n:[]).join(" ")}}},{key:"componentDidMount",value:function t(){this.rootNode=r.findDOMNode(this)}},{key:"render",value:function t(){if(b){return n.createElement(i.Switch,null,this.props.children)}var e=this.props,r=e.className,a=e.location,s=e.children,u=e.timeout,c=e.prefix,f=e.appear,l=e.enter,p=e.exit,y=e.component;var d={appear:f,enter:l,exit:p,component:y};var m={onExit:this.onEnter,onExiting:this.onEntering,onExited:this.onEntered,onEnter:this.onEnter,onEntering:this.onEntering,onEntered:this.onEntered};var h=[c+"-container","react-animated-router",r];return n.createElement(o.TransitionGroup,Object.assign({className:h.filter(Boolean).join(" "),childFactory:function t(e){var r=c+"-"+(T(a,e.props.in)?"forward":"backward");return n.cloneElement(e,{classNames:r})}},d),n.createElement(o.CSSTransition,Object.assign({key:this.props.transitionKey||a.pathname,addEndListener:function t(e,n){e.addEventListener("transitionend",function(t){if(t.target===e){n()}},false)},unmountOnExit:true,timeout:u},m),n.createElement(i.Switch,{location:a},s)))}}]);return e}(e.Component);S.defaultProps={prefix:"animated-router"};var g=i.withRouter(S);exports.default=g;
