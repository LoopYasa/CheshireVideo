{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = undefined;\n\nvar _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _dec, _dec2, _class, _class2, _temp2; //外部依赖包\n//import ReactDOM from 'react-dom';\n//import PropTypes from 'prop-types';\n//内部依赖包\n\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactRedux = require('react-redux');\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _clear = require('../decorator/clear');\n\nvar _clear2 = _interopRequireDefault(_clear);\n\nvar _tooltip = require('../components/tooltip');\n\nvar _tooltip2 = _interopRequireDefault(_tooltip);\n\nvar _slider = require('../components/slider');\n\nvar _slider2 = _interopRequireDefault(_slider);\n\nvar _const = require('../../utils/const');\n\nvar _volume2 = require('../../model/volume');\n\nvar _muted = require('../../model/muted');\n\nvar _video = require('../../model/video');\n\nvar _storage = require('../../utils/storage');\n\nvar storage = _interopRequireWildcard(_storage);\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/**\n * 播放器加载状态的组件\n */\n\n\nvar Volume = (_dec = (0, _reactRedux.connect)(function (state) {\n  return {\n    volume: state[_volume2.namespace],\n    muted: state[_muted.namespace]\n  };\n}), _dec2 = (0, _clear2.default)([_volume2.namespace, _muted.namespace]), _dec(_class = _dec2(_class = (_temp2 = _class2 = function (_React$Component) {\n  (0, _inherits3.default)(Volume, _React$Component);\n\n  function Volume() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    (0, _classCallCheck3.default)(this, Volume);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, (_ref = Volume.__proto__ || (0, _getPrototypeOf2.default)(Volume)).call.apply(_ref, [this].concat(args))), _this), _this.displayName = 'Volume', _this.state = {}, _this.dispatch = _this.props.dispatch, _this.onMuteStateChange = function (e) {\n      e.stopPropagation();\n      var muted = _this.props.muted;\n      var storage_volume = storage.get('volume');\n\n      if (muted && storage_volume !== 0) {\n        //如果是静音，解除静音后原声音值需要还原\n        _this.setVolumeFromLocalStorage();\n      } else if (storage_volume === 0) {\n        _this.dispatch({\n          type: _video.namespace + '/volume',\n          //如果原声音为0，点击静音按钮，设置声音值为10\n          payload: 10\n        });\n      }\n\n      if (storage_volume !== 0) {\n        //进行静音或者取消静音操作\n        _this.dispatch({\n          type: _video.namespace + '/muted',\n          payload: !muted\n        });\n      }\n    }, _this.onSliderChange = function (percent, isMove) {\n      var muted = _this.props.muted;\n\n      if (muted) {\n        //如果是静音，解除静音。\n        _this.dispatch({\n          type: _video.namespace + '/muted',\n          payload: false\n        });\n      }\n\n      _this.dispatch({\n        type: _video.namespace + '/volume',\n        payload: percent * _const.MAX_VOLUME\n      });\n\n      _this.isMove = isMove;\n\n      if (!_this.isMove) {\n        //为false需要触发状态，更新，为true时redux更新了所以不用使用setState\n        _this.setState({\n          random: Math.random()\n        });\n      }\n    }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n  } //这里的配置参考jw-player的api\n\n\n  (0, _createClass3.default)(Volume, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var autoMuted = this.props.autoMuted;\n\n      if (!autoMuted) {\n        setTimeout(function () {\n          //之所以使用setTimeout，是因为切换视频，最外层palyer jsx没销毁，model/video init后于这个这行\n          //这样dispatch就是上一个的视频控制，所以要延时执行。\n          //队列比栈后执行，所以setTimeout，0就足够\n          var storage_muted = storage.get('muted');\n\n          if (storage_muted) {\n            _this2.dispatch({\n              type: _video.namespace + '/muted',\n              payload: true\n            });\n          } else {\n            _this2.setVolumeFromLocalStorage();\n          }\n        }, 0);\n      }\n    }\n  }, {\n    key: 'setVolumeFromLocalStorage',\n    value: function setVolumeFromLocalStorage() {\n      var volume = this.props.volume; //声音可能为0\n\n      var storage_volume = storage.get('volume');\n\n      var _volume = storage_volume || volume;\n\n      if (storage_volume === 0) {\n        //处理storage_volume为0的情况。\n        _volume = 0;\n      }\n\n      this.dispatch({\n        type: _video.namespace + '/volume',\n        payload: _volume\n      });\n    }\n  }, {\n    key: 'renderContent',\n    value: function renderContent() {\n      var volume = this.props.volume;\n      return _react2.default.createElement('div', {\n        className: 'html5-player-volume-slider-container'\n      }, _react2.default.createElement(_slider2.default, {\n        vertical: true,\n        onChange: this.onSliderChange,\n        percent: volume / _const.MAX_VOLUME\n      }));\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          volume = _props.volume,\n          muted = _props.muted,\n          living = _props.living,\n          hasFragment = _props.hasFragment;\n      var toTargetGap = 20;\n\n      if (living) {\n        toTargetGap = 5;\n      } else if (hasFragment) {\n        toTargetGap = 30;\n      }\n\n      return _react2.default.createElement(_tooltip2.default, {\n        content: this.renderContent(),\n        show: this.isMove,\n        toTargetGap: toTargetGap\n      }, _react2.default.createElement('button', {\n        type: 'button',\n        className: 'html5-player-small-button html5-player-volume-button',\n        onClick: this.onMuteStateChange\n      }, _react2.default.createElement('svg', {\n        className: (0, _classnames2.default)('html5-player-icon html5-player-volume-icon', {\n          'html5-player-volume-full-icon': volume === 100 && !muted,\n          'html5-player-volume-x-icon': volume === 0 || muted,\n          'html5-player-volume-part-icon': volume > 0 && volume < 100 && !muted\n        }),\n        'aria-hidden': 'true'\n      }, _react2.default.createElement('use', {\n        xlinkHref: (0, _classnames2.default)({\n          '#icon-volume-full': volume === 100 && !muted,\n          '#icon-volume-x': volume === 0 || muted,\n          '#icon-volume-part': volume > 0 && volume < 100 && !muted\n        })\n      }))));\n    }\n  }]);\n  return Volume;\n}(_react2.default.Component), _class2.propTypes = {}, _temp2)) || _class) || _class);\nexports.default = Volume;","map":{"version":3,"sources":["C:/Users/MaGent/Desktop/video/video/node_modules/html5-player/libs/view/controlbar/volume.js"],"names":["Object","defineProperty","exports","value","default","undefined","_getPrototypeOf","require","_getPrototypeOf2","_interopRequireDefault","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_dec","_dec2","_class","_class2","_temp2","_react","_react2","_reactRedux","_classnames","_classnames2","_clear","_clear2","_tooltip","_tooltip2","_slider","_slider2","_const","_volume2","_muted","_video","_storage","storage","_interopRequireWildcard","obj","__esModule","newObj","key","prototype","hasOwnProperty","call","Volume","connect","state","volume","namespace","muted","_React$Component","_ref","_temp","_this","_ret","_len","arguments","length","args","Array","_key","__proto__","apply","concat","displayName","dispatch","props","onMuteStateChange","e","stopPropagation","storage_volume","get","setVolumeFromLocalStorage","type","payload","onSliderChange","percent","isMove","MAX_VOLUME","setState","random","Math","componentDidMount","_this2","autoMuted","setTimeout","storage_muted","_volume","renderContent","createElement","className","vertical","onChange","render","_props","living","hasFragment","toTargetGap","content","show","onClick","xlinkHref","Component","propTypes"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = undefined;\n\nvar _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _dec, _dec2, _class, _class2, _temp2; //外部依赖包\n\n//import ReactDOM from 'react-dom';\n//import PropTypes from 'prop-types';\n\n//内部依赖包\n\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactRedux = require('react-redux');\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _clear = require('../decorator/clear');\n\nvar _clear2 = _interopRequireDefault(_clear);\n\nvar _tooltip = require('../components/tooltip');\n\nvar _tooltip2 = _interopRequireDefault(_tooltip);\n\nvar _slider = require('../components/slider');\n\nvar _slider2 = _interopRequireDefault(_slider);\n\nvar _const = require('../../utils/const');\n\nvar _volume2 = require('../../model/volume');\n\nvar _muted = require('../../model/muted');\n\nvar _video = require('../../model/video');\n\nvar _storage = require('../../utils/storage');\n\nvar storage = _interopRequireWildcard(_storage);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * 播放器加载状态的组件\n */\nvar Volume = (_dec = (0, _reactRedux.connect)(function (state) {\n  return {\n    volume: state[_volume2.namespace],\n    muted: state[_muted.namespace]\n  };\n}), _dec2 = (0, _clear2.default)([_volume2.namespace, _muted.namespace]), _dec(_class = _dec2(_class = (_temp2 = _class2 = function (_React$Component) {\n  (0, _inherits3.default)(Volume, _React$Component);\n\n  function Volume() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    (0, _classCallCheck3.default)(this, Volume);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, (_ref = Volume.__proto__ || (0, _getPrototypeOf2.default)(Volume)).call.apply(_ref, [this].concat(args))), _this), _this.displayName = 'Volume', _this.state = {}, _this.dispatch = _this.props.dispatch, _this.onMuteStateChange = function (e) {\n      e.stopPropagation();\n      var muted = _this.props.muted;\n\n      var storage_volume = storage.get('volume');\n      if (muted && storage_volume !== 0) {\n        //如果是静音，解除静音后原声音值需要还原\n        _this.setVolumeFromLocalStorage();\n      } else if (storage_volume === 0) {\n        _this.dispatch({\n          type: _video.namespace + '/volume',\n          //如果原声音为0，点击静音按钮，设置声音值为10\n          payload: 10\n        });\n      }\n      if (storage_volume !== 0) {\n        //进行静音或者取消静音操作\n        _this.dispatch({\n          type: _video.namespace + '/muted',\n          payload: !muted\n        });\n      }\n    }, _this.onSliderChange = function (percent, isMove) {\n      var muted = _this.props.muted;\n\n      if (muted) {\n        //如果是静音，解除静音。\n        _this.dispatch({\n          type: _video.namespace + '/muted',\n          payload: false\n        });\n      }\n      _this.dispatch({\n        type: _video.namespace + '/volume',\n        payload: percent * _const.MAX_VOLUME\n      });\n      _this.isMove = isMove;\n      if (!_this.isMove) {\n        //为false需要触发状态，更新，为true时redux更新了所以不用使用setState\n        _this.setState({ random: Math.random() });\n      }\n    }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n  }\n  //这里的配置参考jw-player的api\n\n\n  (0, _createClass3.default)(Volume, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var autoMuted = this.props.autoMuted;\n\n      if (!autoMuted) {\n        setTimeout(function () {\n          //之所以使用setTimeout，是因为切换视频，最外层palyer jsx没销毁，model/video init后于这个这行\n          //这样dispatch就是上一个的视频控制，所以要延时执行。\n          //队列比栈后执行，所以setTimeout，0就足够\n          var storage_muted = storage.get('muted');\n          if (storage_muted) {\n            _this2.dispatch({\n              type: _video.namespace + '/muted',\n              payload: true\n            });\n          } else {\n            _this2.setVolumeFromLocalStorage();\n          }\n        }, 0);\n      }\n    }\n  }, {\n    key: 'setVolumeFromLocalStorage',\n    value: function setVolumeFromLocalStorage() {\n      var volume = this.props.volume;\n      //声音可能为0\n\n      var storage_volume = storage.get('volume');\n      var _volume = storage_volume || volume;\n      if (storage_volume === 0) {\n        //处理storage_volume为0的情况。\n        _volume = 0;\n      }\n      this.dispatch({\n        type: _video.namespace + '/volume',\n        payload: _volume\n      });\n    }\n  }, {\n    key: 'renderContent',\n    value: function renderContent() {\n      var volume = this.props.volume;\n\n      return _react2.default.createElement(\n        'div',\n        { className: 'html5-player-volume-slider-container' },\n        _react2.default.createElement(_slider2.default, {\n          vertical: true,\n          onChange: this.onSliderChange,\n          percent: volume / _const.MAX_VOLUME\n        })\n      );\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          volume = _props.volume,\n          muted = _props.muted,\n          living = _props.living,\n          hasFragment = _props.hasFragment;\n\n      var toTargetGap = 20;\n      if (living) {\n        toTargetGap = 5;\n      } else if (hasFragment) {\n        toTargetGap = 30;\n      }\n      return _react2.default.createElement(\n        _tooltip2.default,\n        {\n          content: this.renderContent(),\n          show: this.isMove,\n          toTargetGap: toTargetGap\n        },\n        _react2.default.createElement(\n          'button',\n          {\n            type: 'button',\n            className: 'html5-player-small-button html5-player-volume-button',\n            onClick: this.onMuteStateChange\n          },\n          _react2.default.createElement(\n            'svg',\n            {\n              className: (0, _classnames2.default)('html5-player-icon html5-player-volume-icon', {\n                'html5-player-volume-full-icon': volume === 100 && !muted,\n                'html5-player-volume-x-icon': volume === 0 || muted,\n                'html5-player-volume-part-icon': volume > 0 && volume < 100 && !muted\n              }),\n              'aria-hidden': 'true'\n            },\n            _react2.default.createElement('use', {\n              xlinkHref: (0, _classnames2.default)({\n                '#icon-volume-full': volume === 100 && !muted,\n                '#icon-volume-x': volume === 0 || muted,\n                '#icon-volume-part': volume > 0 && volume < 100 && !muted\n              })\n            })\n          )\n        )\n      );\n    }\n  }]);\n  return Volume;\n}(_react2.default.Component), _class2.propTypes = {}, _temp2)) || _class) || _class);\nexports.default = Volume;"]},"metadata":{},"sourceType":"script"}