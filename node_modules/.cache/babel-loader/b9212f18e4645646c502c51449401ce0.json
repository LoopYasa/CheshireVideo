{"ast":null,"code":"const THREE = window.THREE = require('three');\n\nconst tween = require('gsap');\n\nwindow.onload = init;\n\nconsole.ward = function () {}; // what warnings?\n\n\nfunction init() {\n  var root = new THREERoot({\n    createCameraControls: !true,\n    antialias: window.devicePixelRatio === 1,\n    fov: 80\n  });\n  root.renderer.setClearColor(0x000000, 0);\n  root.renderer.setPixelRatio(window.devicePixelRatio || 1);\n  root.camera.position.set(0, 0, 60);\n  var width = 100;\n  var height = 60;\n  var slide = new Slide(width, height, 'out');\n  var l1 = new THREE.ImageLoader();\n  l1.setCrossOrigin('Anonymous');\n  slide.setImage(l1.load('https://z3.ax1x.com/2021/06/01/2KY6HK.jpg'));\n  root.scene.add(slide);\n  var slide2 = new Slide(width, height, 'in');\n  var l2 = new THREE.ImageLoader();\n  l2.setCrossOrigin('Anonymous');\n  slide2.setImage(l2.load('https://s3-us-west-2.amazonaws.com/s.cdpn.io/175711/spring.jpg'));\n  root.scene.add(slide2);\n  var tl = new TimelineMax({\n    repeat: -1,\n    repeatDelay: 1.0,\n    yoyo: true\n  });\n  tl.add(slide.transition(), 0);\n  tl.add(slide2.transition(), 0);\n  createTweenScrubber(tl);\n  window.addEventListener('keyup', function (e) {\n    if (e.keyCode === 80) {\n      tl.paused(!tl.paused());\n    }\n  });\n} ////////////////////\n// CLASSES\n////////////////////\n\n\nfunction Slide(width, height, animationPhase) {\n  var plane = new THREE.PlaneGeometry(width, height, width * 2, height * 2);\n  THREE.BAS.Utils.separateFaces(plane);\n  var geometry = new SlideGeometry(plane);\n  geometry.bufferUVs();\n  var aAnimation = geometry.createAttribute('aAnimation', 2);\n  var aStartPosition = geometry.createAttribute('aStartPosition', 3);\n  var aControl0 = geometry.createAttribute('aControl0', 3);\n  var aControl1 = geometry.createAttribute('aControl1', 3);\n  var aEndPosition = geometry.createAttribute('aEndPosition', 3);\n  var i, i2, i3, i4, v;\n  var minDuration = 0.8;\n  var maxDuration = 1.2;\n  var maxDelayX = 0.9;\n  var maxDelayY = 0.125;\n  var stretch = 0.11;\n  this.totalDuration = maxDuration + maxDelayX + maxDelayY + stretch;\n  var startPosition = new THREE.Vector3();\n  var control0 = new THREE.Vector3();\n  var control1 = new THREE.Vector3();\n  var endPosition = new THREE.Vector3();\n  var tempPoint = new THREE.Vector3();\n\n  function getControlPoint0(centroid) {\n    var signY = Math.sign(centroid.y);\n    tempPoint.x = THREE.Math.randFloat(0.1, 0.3) * 50;\n    tempPoint.y = signY * THREE.Math.randFloat(0.1, 0.3) * 70;\n    tempPoint.z = THREE.Math.randFloatSpread(20);\n    return tempPoint;\n  }\n\n  function getControlPoint1(centroid) {\n    var signY = Math.sign(centroid.y);\n    tempPoint.x = THREE.Math.randFloat(0.3, 0.6) * 50;\n    tempPoint.y = -signY * THREE.Math.randFloat(0.3, 0.6) * 70;\n    tempPoint.z = THREE.Math.randFloatSpread(20);\n    return tempPoint;\n  }\n\n  for (i = 0, i2 = 0, i3 = 0, i4 = 0; i < geometry.faceCount; i++, i2 += 6, i3 += 9, i4 += 12) {\n    var face = plane.faces[i];\n    var centroid = THREE.BAS.Utils.computeCentroid(plane, face); // animation\n\n    var duration = THREE.Math.randFloat(minDuration, maxDuration);\n    var delayX = THREE.Math.mapLinear(centroid.x, -width * 0.5, width * 0.5, 0.0, maxDelayX);\n    var delayY;\n\n    if (animationPhase === 'in') {\n      delayY = THREE.Math.mapLinear(Math.abs(centroid.y), 0, height * 0.5, 0.0, maxDelayY);\n    } else {\n      delayY = THREE.Math.mapLinear(Math.abs(centroid.y), 0, height * 0.5, maxDelayY, 0.0);\n    }\n\n    for (v = 0; v < 6; v += 2) {\n      aAnimation.array[i2 + v] = delayX + delayY + Math.random() * stretch * duration;\n      aAnimation.array[i2 + v + 1] = duration;\n    } // positions\n\n\n    endPosition.copy(centroid);\n    startPosition.copy(centroid);\n\n    if (animationPhase === 'in') {\n      control0.copy(centroid).sub(getControlPoint0(centroid));\n      control1.copy(centroid).sub(getControlPoint1(centroid));\n    } else {\n      // out\n      control0.copy(centroid).add(getControlPoint0(centroid));\n      control1.copy(centroid).add(getControlPoint1(centroid));\n    }\n\n    for (v = 0; v < 9; v += 3) {\n      aStartPosition.array[i3 + v] = startPosition.x;\n      aStartPosition.array[i3 + v + 1] = startPosition.y;\n      aStartPosition.array[i3 + v + 2] = startPosition.z;\n      aControl0.array[i3 + v] = control0.x;\n      aControl0.array[i3 + v + 1] = control0.y;\n      aControl0.array[i3 + v + 2] = control0.z;\n      aControl1.array[i3 + v] = control1.x;\n      aControl1.array[i3 + v + 1] = control1.y;\n      aControl1.array[i3 + v + 2] = control1.z;\n      aEndPosition.array[i3 + v] = endPosition.x;\n      aEndPosition.array[i3 + v + 1] = endPosition.y;\n      aEndPosition.array[i3 + v + 2] = endPosition.z;\n    }\n  }\n\n  var material = new THREE.BAS.BasicAnimationMaterial({\n    shading: THREE.FlatShading,\n    side: THREE.DoubleSide,\n    uniforms: {\n      uTime: {\n        type: 'f',\n        value: 0\n      }\n    },\n    shaderFunctions: [THREE.BAS.ShaderChunk['cubic_bezier'], //THREE.BAS.ShaderChunk[(animationPhase === 'in' ? 'ease_out_cubic' : 'ease_in_cubic')],\n    THREE.BAS.ShaderChunk['ease_in_out_cubic'], THREE.BAS.ShaderChunk['quaternion_rotation']],\n    shaderParameters: ['uniform float uTime;', 'attribute vec2 aAnimation;', 'attribute vec3 aStartPosition;', 'attribute vec3 aControl0;', 'attribute vec3 aControl1;', 'attribute vec3 aEndPosition;'],\n    shaderVertexInit: ['float tDelay = aAnimation.x;', 'float tDuration = aAnimation.y;', 'float tTime = clamp(uTime - tDelay, 0.0, tDuration);', 'float tProgress = ease(tTime, 0.0, 1.0, tDuration);' //'float tProgress = tTime / tDuration;'\n    ],\n    shaderTransformPosition: [animationPhase === 'in' ? 'transformed *= tProgress;' : 'transformed *= 1.0 - tProgress;', 'transformed += cubicBezier(aStartPosition, aControl0, aControl1, aEndPosition, tProgress);']\n  }, {\n    map: new THREE.Texture()\n  });\n  THREE.Mesh.call(this, geometry, material);\n  this.frustumCulled = false;\n}\n\n_c = Slide;\nSlide.prototype = Object.create(THREE.Mesh.prototype);\nSlide.prototype.constructor = Slide;\nObject.defineProperty(Slide.prototype, 'time', {\n  get: function () {\n    return this.material.uniforms['uTime'].value;\n  },\n  set: function (v) {\n    this.material.uniforms['uTime'].value = v;\n  }\n});\n\nSlide.prototype.setImage = function (image) {\n  this.material.uniforms.map.value.image = image;\n  this.material.uniforms.map.value.needsUpdate = true;\n};\n\nSlide.prototype.transition = function () {\n  return TweenMax.fromTo(this, 3.0, {\n    time: 0.0\n  }, {\n    time: this.totalDuration,\n    ease: Power0.easeInOut\n  });\n};\n\nfunction SlideGeometry(model) {\n  THREE.BAS.ModelBufferGeometry.call(this, model);\n}\n\n_c2 = SlideGeometry;\nSlideGeometry.prototype = Object.create(THREE.BAS.ModelBufferGeometry.prototype);\nSlideGeometry.prototype.constructor = SlideGeometry;\n\nSlideGeometry.prototype.bufferPositions = function () {\n  var positionBuffer = this.createAttribute('position', 3).array;\n\n  for (var i = 0; i < this.faceCount; i++) {\n    var face = this.modelGeometry.faces[i];\n    var centroid = THREE.BAS.Utils.computeCentroid(this.modelGeometry, face);\n    var a = this.modelGeometry.vertices[face.a];\n    var b = this.modelGeometry.vertices[face.b];\n    var c = this.modelGeometry.vertices[face.c];\n    positionBuffer[face.a * 3] = a.x - centroid.x;\n    positionBuffer[face.a * 3 + 1] = a.y - centroid.y;\n    positionBuffer[face.a * 3 + 2] = a.z - centroid.z;\n    positionBuffer[face.b * 3] = b.x - centroid.x;\n    positionBuffer[face.b * 3 + 1] = b.y - centroid.y;\n    positionBuffer[face.b * 3 + 2] = b.z - centroid.z;\n    positionBuffer[face.c * 3] = c.x - centroid.x;\n    positionBuffer[face.c * 3 + 1] = c.y - centroid.y;\n    positionBuffer[face.c * 3 + 2] = c.z - centroid.z;\n  }\n};\n\nfunction THREERoot(params) {\n  params = utils.extend({\n    fov: 60,\n    zNear: 10,\n    zFar: 100000,\n    createCameraControls: true\n  }, params);\n  this.renderer = new THREE.WebGLRenderer({\n    antialias: params.antialias,\n    alpha: true\n  });\n  this.renderer.setPixelRatio(Math.min(2, window.devicePixelRatio || 1));\n  document.getElementById('three-container').appendChild(this.renderer.domElement);\n  this.camera = new THREE.PerspectiveCamera(params.fov, window.innerWidth / window.innerHeight, params.zNear, params.zfar);\n  this.scene = new THREE.Scene();\n\n  if (params.createCameraControls) {\n    this.controls = new THREE.OrbitControls(this.camera, this.renderer.domElement);\n  }\n\n  this.resize = this.resize.bind(this);\n  this.tick = this.tick.bind(this);\n  this.resize();\n  this.tick();\n  window.addEventListener('resize', this.resize, false);\n}\n\n_c3 = THREERoot;\nTHREERoot.prototype = {\n  tick: function () {\n    this.update();\n    this.render();\n    requestAnimationFrame(this.tick);\n  },\n  update: function () {\n    this.controls && this.controls.update();\n  },\n  render: function () {\n    this.renderer.render(this.scene, this.camera);\n  },\n  resize: function () {\n    this.camera.aspect = window.innerWidth / window.innerHeight;\n    this.camera.updateProjectionMatrix();\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\n  }\n}; ////////////////////\n// UTILS\n////////////////////\n\nvar utils = {\n  extend: function (dst, src) {\n    for (var key in src) {\n      dst[key] = src[key];\n    }\n\n    return dst;\n  },\n  randSign: function () {\n    return Math.random() > 0.5 ? 1 : -1;\n  },\n  ease: function (ease, t, b, c, d) {\n    return b + ease.getRatio(t / d) * c;\n  },\n  fibSpherePoint: function () {\n    var vec = {\n      x: 0,\n      y: 0,\n      z: 0\n    };\n    var G = Math.PI * (3 - Math.sqrt(5));\n    return function (i, n, radius) {\n      var step = 2.0 / n;\n      var r, phi;\n      vec.y = i * step - 1 + step * 0.5;\n      r = Math.sqrt(1 - vec.y * vec.y);\n      phi = i * G;\n      vec.x = Math.cos(phi) * r;\n      vec.z = Math.sin(phi) * r;\n      radius = radius || 1;\n      vec.x *= radius;\n      vec.y *= radius;\n      vec.z *= radius;\n      return vec;\n    };\n  }(),\n  spherePoint: function () {\n    return function (u, v) {\n      u === undefined && (u = Math.random());\n      v === undefined && (v = Math.random());\n      var theta = 2 * Math.PI * u;\n      var phi = Math.acos(2 * v - 1);\n      var vec = {};\n      vec.x = Math.sin(phi) * Math.cos(theta);\n      vec.y = Math.sin(phi) * Math.sin(theta);\n      vec.z = Math.cos(phi);\n      return vec;\n    };\n  }()\n};\n\nfunction createTweenScrubber(tween, seekSpeed) {\n  seekSpeed = seekSpeed || 0.001;\n\n  function stop() {\n    TweenMax.to(tween, 1, {\n      timeScale: 0\n    });\n  }\n\n  function resume() {\n    TweenMax.to(tween, 1, {\n      timeScale: 1\n    });\n  }\n\n  function seek(dx) {\n    var progress = tween.progress();\n    var p = THREE.Math.clamp(progress + dx * seekSpeed, 0, 1);\n    tween.progress(p);\n  }\n\n  var _cx = 0; // desktop\n\n  var mouseDown = false;\n  document.body.style.cursor = 'pointer';\n  window.addEventListener('mousedown', function (e) {\n    mouseDown = true;\n    document.body.style.cursor = 'ew-resize';\n    _cx = e.clientX;\n    stop();\n  });\n  window.addEventListener('mouseup', function (e) {\n    mouseDown = false;\n    document.body.style.cursor = 'pointer';\n    resume();\n  });\n  window.addEventListener('mousemove', function (e) {\n    if (mouseDown === true) {\n      var cx = e.clientX;\n      var dx = cx - _cx;\n      _cx = cx;\n      seek(dx);\n    }\n  }); // mobile\n\n  window.addEventListener('touchstart', function (e) {\n    _cx = e.touches[0].clientX;\n    stop();\n    e.preventDefault();\n  });\n  window.addEventListener('touchend', function (e) {\n    resume();\n    e.preventDefault();\n  });\n  window.addEventListener('touchmove', function (e) {\n    var cx = e.touches[0].clientX;\n    var dx = cx - _cx;\n    _cx = cx;\n    seek(dx);\n    e.preventDefault();\n  });\n}\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"Slide\");\n$RefreshReg$(_c2, \"SlideGeometry\");\n$RefreshReg$(_c3, \"THREERoot\");","map":{"version":3,"sources":["C:/Users/MaGent/Desktop/video/video/src/components/Swiper/index.js"],"names":["THREE","window","require","tween","onload","init","console","ward","root","THREERoot","createCameraControls","antialias","devicePixelRatio","fov","renderer","setClearColor","setPixelRatio","camera","position","set","width","height","slide","Slide","l1","ImageLoader","setCrossOrigin","setImage","load","scene","add","slide2","l2","tl","TimelineMax","repeat","repeatDelay","yoyo","transition","createTweenScrubber","addEventListener","e","keyCode","paused","animationPhase","plane","PlaneGeometry","BAS","Utils","separateFaces","geometry","SlideGeometry","bufferUVs","aAnimation","createAttribute","aStartPosition","aControl0","aControl1","aEndPosition","i","i2","i3","i4","v","minDuration","maxDuration","maxDelayX","maxDelayY","stretch","totalDuration","startPosition","Vector3","control0","control1","endPosition","tempPoint","getControlPoint0","centroid","signY","Math","sign","y","x","randFloat","z","randFloatSpread","getControlPoint1","faceCount","face","faces","computeCentroid","duration","delayX","mapLinear","delayY","abs","array","random","copy","sub","material","BasicAnimationMaterial","shading","FlatShading","side","DoubleSide","uniforms","uTime","type","value","shaderFunctions","ShaderChunk","shaderParameters","shaderVertexInit","shaderTransformPosition","map","Texture","Mesh","call","frustumCulled","prototype","Object","create","constructor","defineProperty","get","image","needsUpdate","TweenMax","fromTo","time","ease","Power0","easeInOut","model","ModelBufferGeometry","bufferPositions","positionBuffer","modelGeometry","a","vertices","b","c","params","utils","extend","zNear","zFar","WebGLRenderer","alpha","min","document","getElementById","appendChild","domElement","PerspectiveCamera","innerWidth","innerHeight","zfar","Scene","controls","OrbitControls","resize","bind","tick","update","render","requestAnimationFrame","aspect","updateProjectionMatrix","setSize","dst","src","key","randSign","t","d","getRatio","fibSpherePoint","vec","G","PI","sqrt","n","radius","step","r","phi","cos","sin","spherePoint","u","undefined","theta","acos","seekSpeed","stop","to","timeScale","resume","seek","dx","progress","p","clamp","_cx","mouseDown","body","style","cursor","clientX","cx","touches","preventDefault"],"mappings":"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","sourcesContent":["const THREE = window.THREE = require('three')\r\nconst tween = require('gsap')\r\n\r\n\r\nwindow.onload = init;\r\nconsole.ward = function() {}; // what warnings?\r\n\r\nfunction init() {\r\n  var root = new THREERoot({\r\n    createCameraControls: !true,\r\n    antialias: (window.devicePixelRatio === 1),\r\n    fov: 80\r\n  });\r\n \r\n\r\n  root.renderer.setClearColor(0x000000, 0);\r\n  root.renderer.setPixelRatio(window.devicePixelRatio || 1);\r\n  root.camera.position.set(0, 0, 60);\r\n\r\n  var width = 100;\r\n  var height = 60;\r\n\r\n  var slide = new Slide(width, height, 'out');\r\n\tvar l1 = new THREE.ImageLoader();\r\n\tl1.setCrossOrigin('Anonymous');\r\n  slide.setImage(l1.load('https://z3.ax1x.com/2021/06/01/2KY6HK.jpg'));\r\n  root.scene.add(slide);\r\n\r\n  var slide2 = new Slide(width, height, 'in');\r\n  var l2 = new THREE.ImageLoader();\r\n\tl2.setCrossOrigin('Anonymous');\r\n\tslide2.setImage(l2.load('https://s3-us-west-2.amazonaws.com/s.cdpn.io/175711/spring.jpg'));\r\n  root.scene.add(slide2);\r\n\r\n  var tl = new TimelineMax({repeat:-1, repeatDelay:1.0, yoyo: true});\r\n\r\n  tl.add(slide.transition(), 0);\r\n  tl.add(slide2.transition(), 0);\r\n\r\n  createTweenScrubber(tl);\r\n\r\n  window.addEventListener('keyup', function(e) {\r\n    if (e.keyCode === 80) {\r\n      tl.paused(!tl.paused());\r\n    }\r\n  });\r\n}\r\n\r\n////////////////////\r\n// CLASSES\r\n////////////////////\r\n\r\nfunction Slide(width, height, animationPhase) {\r\n  var plane = new THREE.PlaneGeometry(width, height, width * 2, height * 2);\r\n\r\n  THREE.BAS.Utils.separateFaces(plane);\r\n\r\n  var geometry = new SlideGeometry(plane);\r\n\r\n  geometry.bufferUVs();\r\n\r\n  var aAnimation = geometry.createAttribute('aAnimation', 2);\r\n  var aStartPosition = geometry.createAttribute('aStartPosition', 3);\r\n  var aControl0 = geometry.createAttribute('aControl0', 3);\r\n  var aControl1 = geometry.createAttribute('aControl1', 3);\r\n  var aEndPosition = geometry.createAttribute('aEndPosition', 3);\r\n\r\n  var i, i2, i3, i4, v;\r\n\r\n  var minDuration = 0.8;\r\n  var maxDuration = 1.2;\r\n  var maxDelayX = 0.9;\r\n  var maxDelayY = 0.125;\r\n  var stretch = 0.11;\r\n\r\n  this.totalDuration = maxDuration + maxDelayX + maxDelayY + stretch;\r\n\r\n  var startPosition = new THREE.Vector3();\r\n  var control0 = new THREE.Vector3();\r\n  var control1 = new THREE.Vector3();\r\n  var endPosition = new THREE.Vector3();\r\n\r\n  var tempPoint = new THREE.Vector3();\r\n\r\n  function getControlPoint0(centroid) {\r\n    var signY = Math.sign(centroid.y);\r\n\r\n    tempPoint.x = THREE.Math.randFloat(0.1, 0.3) * 50;\r\n    tempPoint.y = signY * THREE.Math.randFloat(0.1, 0.3) * 70;\r\n    tempPoint.z = THREE.Math.randFloatSpread(20);\r\n\r\n    return tempPoint;\r\n  }\r\n\r\n  function getControlPoint1(centroid) {\r\n    var signY = Math.sign(centroid.y);\r\n\r\n    tempPoint.x = THREE.Math.randFloat(0.3, 0.6) * 50;\r\n    tempPoint.y = -signY * THREE.Math.randFloat(0.3, 0.6) * 70;\r\n    tempPoint.z = THREE.Math.randFloatSpread(20);\r\n\r\n    return tempPoint;\r\n  }\r\n\r\n  for (i = 0, i2 = 0, i3 = 0, i4 = 0; i < geometry.faceCount; i++, i2 += 6, i3 += 9, i4 += 12) {\r\n    var face = plane.faces[i];\r\n    var centroid = THREE.BAS.Utils.computeCentroid(plane, face);\r\n\r\n    // animation\r\n    var duration = THREE.Math.randFloat(minDuration, maxDuration);\r\n    var delayX = THREE.Math.mapLinear(centroid.x, -width * 0.5, width * 0.5, 0.0, maxDelayX);\r\n    var delayY;\r\n\r\n    if (animationPhase === 'in') {\r\n      delayY = THREE.Math.mapLinear(Math.abs(centroid.y), 0, height * 0.5, 0.0, maxDelayY)\r\n    }\r\n    else {\r\n      delayY = THREE.Math.mapLinear(Math.abs(centroid.y), 0, height * 0.5, maxDelayY, 0.0)\r\n    }\r\n\r\n    for (v = 0; v < 6; v += 2) {\r\n      aAnimation.array[i2 + v]     = delayX + delayY + (Math.random() * stretch * duration);\r\n      aAnimation.array[i2 + v + 1] = duration;\r\n    }\r\n\r\n    // positions\r\n\r\n    endPosition.copy(centroid);\r\n    startPosition.copy(centroid);\r\n\r\n    if (animationPhase === 'in') {\r\n      control0.copy(centroid).sub(getControlPoint0(centroid));\r\n      control1.copy(centroid).sub(getControlPoint1(centroid));\r\n    }\r\n    else { // out\r\n      control0.copy(centroid).add(getControlPoint0(centroid));\r\n      control1.copy(centroid).add(getControlPoint1(centroid));\r\n    }\r\n\r\n    for (v = 0; v < 9; v += 3) {\r\n      aStartPosition.array[i3 + v]     = startPosition.x;\r\n      aStartPosition.array[i3 + v + 1] = startPosition.y;\r\n      aStartPosition.array[i3 + v + 2] = startPosition.z;\r\n\r\n      aControl0.array[i3 + v]     = control0.x;\r\n      aControl0.array[i3 + v + 1] = control0.y;\r\n      aControl0.array[i3 + v + 2] = control0.z;\r\n\r\n      aControl1.array[i3 + v]     = control1.x;\r\n      aControl1.array[i3 + v + 1] = control1.y;\r\n      aControl1.array[i3 + v + 2] = control1.z;\r\n\r\n      aEndPosition.array[i3 + v]     = endPosition.x;\r\n      aEndPosition.array[i3 + v + 1] = endPosition.y;\r\n      aEndPosition.array[i3 + v + 2] = endPosition.z;\r\n    }\r\n  }\r\n\r\n  var material = new THREE.BAS.BasicAnimationMaterial(\r\n    {\r\n      shading: THREE.FlatShading,\r\n      side: THREE.DoubleSide,\r\n      uniforms: {\r\n        uTime: {type: 'f', value: 0}\r\n      },\r\n      shaderFunctions: [\r\n        THREE.BAS.ShaderChunk['cubic_bezier'],\r\n        //THREE.BAS.ShaderChunk[(animationPhase === 'in' ? 'ease_out_cubic' : 'ease_in_cubic')],\r\n        THREE.BAS.ShaderChunk['ease_in_out_cubic'],\r\n        THREE.BAS.ShaderChunk['quaternion_rotation']\r\n      ],\r\n      shaderParameters: [\r\n        'uniform float uTime;',\r\n        'attribute vec2 aAnimation;',\r\n        'attribute vec3 aStartPosition;',\r\n        'attribute vec3 aControl0;',\r\n        'attribute vec3 aControl1;',\r\n        'attribute vec3 aEndPosition;',\r\n      ],\r\n      shaderVertexInit: [\r\n        'float tDelay = aAnimation.x;',\r\n        'float tDuration = aAnimation.y;',\r\n        'float tTime = clamp(uTime - tDelay, 0.0, tDuration);',\r\n        'float tProgress = ease(tTime, 0.0, 1.0, tDuration);'\r\n        //'float tProgress = tTime / tDuration;'\r\n      ],\r\n      shaderTransformPosition: [\r\n        (animationPhase === 'in' ? 'transformed *= tProgress;' : 'transformed *= 1.0 - tProgress;'),\r\n        'transformed += cubicBezier(aStartPosition, aControl0, aControl1, aEndPosition, tProgress);'\r\n      ]\r\n    },\r\n    {\r\n      map: new THREE.Texture(),\r\n    }\r\n  );\r\n\r\n  THREE.Mesh.call(this, geometry, material);\r\n\r\n  this.frustumCulled = false;\r\n}\r\nSlide.prototype = Object.create(THREE.Mesh.prototype);\r\nSlide.prototype.constructor = Slide;\r\nObject.defineProperty(Slide.prototype, 'time', {\r\n  get: function () {\r\n    return this.material.uniforms['uTime'].value;\r\n  },\r\n  set: function (v) {\r\n    this.material.uniforms['uTime'].value = v;\r\n  }\r\n});\r\n\r\nSlide.prototype.setImage = function(image) {\r\n  this.material.uniforms.map.value.image = image;\r\n  this.material.uniforms.map.value.needsUpdate = true;\r\n};\r\n\r\nSlide.prototype.transition = function() {\r\n  return TweenMax.fromTo(this, 3.0, {time:0.0}, {time:this.totalDuration, ease:Power0.easeInOut});\r\n};\r\n\r\n\r\nfunction SlideGeometry(model) {\r\n  THREE.BAS.ModelBufferGeometry.call(this, model);\r\n}\r\nSlideGeometry.prototype = Object.create(THREE.BAS.ModelBufferGeometry.prototype);\r\nSlideGeometry.prototype.constructor = SlideGeometry;\r\nSlideGeometry.prototype.bufferPositions = function () {\r\n  var positionBuffer = this.createAttribute('position', 3).array;\r\n\r\n  for (var i = 0; i < this.faceCount; i++) {\r\n    var face = this.modelGeometry.faces[i];\r\n    var centroid = THREE.BAS.Utils.computeCentroid(this.modelGeometry, face);\r\n\r\n    var a = this.modelGeometry.vertices[face.a];\r\n    var b = this.modelGeometry.vertices[face.b];\r\n    var c = this.modelGeometry.vertices[face.c];\r\n\r\n    positionBuffer[face.a * 3]     = a.x - centroid.x;\r\n    positionBuffer[face.a * 3 + 1] = a.y - centroid.y;\r\n    positionBuffer[face.a * 3 + 2] = a.z - centroid.z;\r\n\r\n    positionBuffer[face.b * 3]     = b.x - centroid.x;\r\n    positionBuffer[face.b * 3 + 1] = b.y - centroid.y;\r\n    positionBuffer[face.b * 3 + 2] = b.z - centroid.z;\r\n\r\n    positionBuffer[face.c * 3]     = c.x - centroid.x;\r\n    positionBuffer[face.c * 3 + 1] = c.y - centroid.y;\r\n    positionBuffer[face.c * 3 + 2] = c.z - centroid.z;\r\n  }\r\n};\r\n\r\n\r\nfunction THREERoot(params) {\r\n  params = utils.extend({\r\n    fov: 60,\r\n    zNear: 10,\r\n    zFar: 100000,\r\n\r\n    createCameraControls: true\r\n  }, params);\r\n\r\n  this.renderer = new THREE.WebGLRenderer({\r\n    antialias: params.antialias,\r\n    alpha: true\r\n  });\r\n  this.renderer.setPixelRatio(Math.min(2, window.devicePixelRatio || 1));\r\n  document.getElementById('three-container').appendChild(this.renderer.domElement);\r\n\r\n  this.camera = new THREE.PerspectiveCamera(\r\n    params.fov,\r\n    window.innerWidth / window.innerHeight,\r\n    params.zNear,\r\n    params.zfar\r\n  );\r\n\r\n  this.scene = new THREE.Scene();\r\n\r\n  if (params.createCameraControls) {\r\n    this.controls = new THREE.OrbitControls(this.camera, this.renderer.domElement);\r\n  }\r\n\r\n  this.resize = this.resize.bind(this);\r\n  this.tick = this.tick.bind(this);\r\n\r\n  this.resize();\r\n  this.tick();\r\n\r\n  window.addEventListener('resize', this.resize, false);\r\n}\r\nTHREERoot.prototype = {\r\n  tick: function () {\r\n    this.update();\r\n    this.render();\r\n    requestAnimationFrame(this.tick);\r\n  },\r\n  update: function () {\r\n    this.controls && this.controls.update();\r\n  },\r\n  render: function () {\r\n    this.renderer.render(this.scene, this.camera);\r\n  },\r\n  resize: function () {\r\n    this.camera.aspect = window.innerWidth / window.innerHeight;\r\n    this.camera.updateProjectionMatrix();\r\n\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n  }\r\n};\r\n\r\n////////////////////\r\n// UTILS\r\n////////////////////\r\n\r\nvar utils = {\r\n  extend: function (dst, src) {\r\n    for (var key in src) {\r\n      dst[key] = src[key];\r\n    }\r\n\r\n    return dst;\r\n  },\r\n  randSign: function () {\r\n    return Math.random() > 0.5 ? 1 : -1;\r\n  },\r\n  ease: function (ease, t, b, c, d) {\r\n    return b + ease.getRatio(t / d) * c;\r\n  },\r\n  fibSpherePoint: (function () {\r\n    var vec = {x: 0, y: 0, z: 0};\r\n    var G = Math.PI * (3 - Math.sqrt(5));\r\n\r\n    return function (i, n, radius) {\r\n      var step = 2.0 / n;\r\n      var r, phi;\r\n\r\n      vec.y = i * step - 1 + (step * 0.5);\r\n      r = Math.sqrt(1 - vec.y * vec.y);\r\n      phi = i * G;\r\n      vec.x = Math.cos(phi) * r;\r\n      vec.z = Math.sin(phi) * r;\r\n\r\n      radius = radius || 1;\r\n\r\n      vec.x *= radius;\r\n      vec.y *= radius;\r\n      vec.z *= radius;\r\n\r\n      return vec;\r\n    }\r\n  })(),\r\n  spherePoint: (function () {\r\n    return function (u, v) {\r\n      u === undefined && (u = Math.random());\r\n      v === undefined && (v = Math.random());\r\n\r\n      var theta = 2 * Math.PI * u;\r\n      var phi = Math.acos(2 * v - 1);\r\n\r\n      var vec = {};\r\n      vec.x = (Math.sin(phi) * Math.cos(theta));\r\n      vec.y = (Math.sin(phi) * Math.sin(theta));\r\n      vec.z = (Math.cos(phi));\r\n\r\n      return vec;\r\n    }\r\n  })()\r\n};\r\n\r\nfunction createTweenScrubber(tween, seekSpeed) {\r\n  seekSpeed = seekSpeed || 0.001;\r\n\r\n  function stop() {\r\n    TweenMax.to(tween, 1, {timeScale:0});\r\n  }\r\n\r\n  function resume() {\r\n    TweenMax.to(tween, 1, {timeScale:1});\r\n  }\r\n\r\n  function seek(dx) {\r\n    var progress = tween.progress();\r\n    var p = THREE.Math.clamp((progress + (dx * seekSpeed)), 0, 1);\r\n\r\n    tween.progress(p);\r\n  }\r\n\r\n  var _cx = 0;\r\n\r\n  // desktop\r\n  var mouseDown = false;\r\n  document.body.style.cursor = 'pointer';\r\n\r\n  window.addEventListener('mousedown', function(e) {\r\n    mouseDown = true;\r\n    document.body.style.cursor = 'ew-resize';\r\n    _cx = e.clientX;\r\n    stop();\r\n  });\r\n  window.addEventListener('mouseup', function(e) {\r\n    mouseDown = false;\r\n    document.body.style.cursor = 'pointer';\r\n    resume();\r\n  });\r\n  window.addEventListener('mousemove', function(e) {\r\n    if (mouseDown === true) {\r\n      var cx = e.clientX;\r\n      var dx = cx - _cx;\r\n      _cx = cx;\r\n\r\n      seek(dx);\r\n    }\r\n  });\r\n  // mobile\r\n  window.addEventListener('touchstart', function(e) {\r\n    _cx = e.touches[0].clientX;\r\n    stop();\r\n    e.preventDefault();\r\n  });\r\n  window.addEventListener('touchend', function(e) {\r\n    resume();\r\n    e.preventDefault();\r\n  });\r\n  window.addEventListener('touchmove', function(e) {\r\n    var cx = e.touches[0].clientX;\r\n    var dx = cx - _cx;\r\n    _cx = cx;\r\n\r\n    seek(dx);\r\n    e.preventDefault();\r\n  });\r\n}\r\n"]},"metadata":{},"sourceType":"module"}