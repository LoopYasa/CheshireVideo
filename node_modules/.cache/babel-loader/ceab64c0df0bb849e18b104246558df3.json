{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = undefined;\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _api = require('./api');\n\nvar _api2 = _interopRequireDefault(_api);\n\nvar _logger = require('../utils/logger');\n\nvar logger = _interopRequireWildcard(_logger);\n\nvar _const = require('../utils//const');\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar flvAPI = function (_API) {\n  (0, _inherits3.default)(flvAPI, _API);\n\n  function flvAPI(videoDOM, file, flvjs) {\n    var _this2, _ret;\n\n    var flvConfig = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    (0, _classCallCheck3.default)(this, flvAPI);\n\n    var _this = (_this2 = (0, _possibleConstructorReturn3.default)(this, (flvAPI.__proto__ || (0, _getPrototypeOf2.default)(flvAPI)).call(this, videoDOM, file)), _this2);\n\n    _this2.flvConfig = flvConfig;\n\n    if (flvjs.isSupported()) {\n      flvjs.LoggingControl.enableDebug = false;\n      flvjs.LoggingControl.enableVerbose = false;\n      flvjs.LoggingControl.enableWarn = false;\n      _this2.flvjs = flvjs;\n    }\n\n    return _ret = _this, (0, _possibleConstructorReturn3.default)(_this2, _ret);\n  }\n\n  (0, _createClass3.default)(flvAPI, [{\n    key: 'detachMedia',\n    value: function detachMedia() {\n      var player = this.flvPlayer;\n\n      if (player) {\n        this.pause();\n        this.detachEvent();\n        player.unload();\n        player.detachMediaElement();\n        player.destroy();\n        this.flvPlayer = null;\n        logger.success('Detach Media:', 'detach media for flv.js sucessfully.');\n      }\n\n      this.videoDOM.src = '';\n    } //载入视频源，这里不可以用箭头函数\n\n  }, {\n    key: 'loadSource',\n    value: function loadSource(file) {\n      var flvjs = this.flvjs;\n\n      if (flvjs) {\n        var flvPlayer = flvjs.createPlayer({\n          type: 'flv',\n          url: file\n        }, (0, _extends3.default)({}, this.flvConfig));\n        this.flvPlayer = flvPlayer;\n        flvPlayer.attachMediaElement(this);\n        flvPlayer.load();\n        logger.info('Source Loading :', 'loading flv video.'); //flv的log事件是全局的，这是个坑\n\n        this.attachEvent();\n      }\n    }\n  }, {\n    key: 'detachEvent',\n    value: function detachEvent() {\n      if (this.LoggingControlListener && _const.DEBUG) {\n        this.flvjs.LoggingControl.removeLogListener(this.LoggingControlListener);\n      }\n    }\n  }, {\n    key: 'attachEvent',\n    value: function attachEvent() {\n      if (!_const.DEBUG) {\n        return;\n      } // const locale = this.localization;\n\n\n      var errorTitle = 'Flv.js Error,';\n\n      if (this.flvjs) {\n        this.LoggingControlListener = function (type, str) {\n          if (type === 'error') {\n            // let message;\n            if (~str.indexOf('IOController')) {\n              logger.error(errorTitle, 'load error'); // message = locale.fileCouldNotPlay;\n              // //一般trigger都是为了对外提供api，error是个比较特殊的情况，寄对外提供了事件，也对内提供了事件。\n              // //如果只是对内不对外的话，不可以使用trigger处理事件，所有的都用redux。\n              // this.event.trigger('error', {\n              //   data: str,\n              //   message,\n              //   type,\n              // });\n            }\n          }\n        };\n\n        this.flvjs.LoggingControl.addLogListener(this.LoggingControlListener);\n      }\n    }\n  }]);\n  return flvAPI;\n}(_api2.default);\n\nexports.default = flvAPI;","map":{"version":3,"sources":["C:/Users/MaGent/Desktop/video/video/node_modules/html5-player/libs/api/flvjs-api.js"],"names":["Object","defineProperty","exports","value","default","undefined","_extends2","require","_extends3","_interopRequireDefault","_getPrototypeOf","_getPrototypeOf2","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_api","_api2","_logger","logger","_interopRequireWildcard","_const","obj","__esModule","newObj","key","prototype","hasOwnProperty","call","flvAPI","_API","videoDOM","file","flvjs","_this2","_ret","flvConfig","arguments","length","_this","__proto__","isSupported","LoggingControl","enableDebug","enableVerbose","enableWarn","detachMedia","player","flvPlayer","pause","detachEvent","unload","detachMediaElement","destroy","success","src","loadSource","createPlayer","type","url","attachMediaElement","load","info","attachEvent","LoggingControlListener","DEBUG","removeLogListener","errorTitle","str","indexOf","error","addLogListener"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = undefined;\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _api = require('./api');\n\nvar _api2 = _interopRequireDefault(_api);\n\nvar _logger = require('../utils/logger');\n\nvar logger = _interopRequireWildcard(_logger);\n\nvar _const = require('../utils//const');\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar flvAPI = function (_API) {\n  (0, _inherits3.default)(flvAPI, _API);\n\n  function flvAPI(videoDOM, file, flvjs) {\n    var _this2, _ret;\n\n    var flvConfig = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    (0, _classCallCheck3.default)(this, flvAPI);\n\n    var _this = (_this2 = (0, _possibleConstructorReturn3.default)(this, (flvAPI.__proto__ || (0, _getPrototypeOf2.default)(flvAPI)).call(this, videoDOM, file)), _this2);\n    _this2.flvConfig = flvConfig;\n    if (flvjs.isSupported()) {\n      flvjs.LoggingControl.enableDebug = false;\n      flvjs.LoggingControl.enableVerbose = false;\n      flvjs.LoggingControl.enableWarn = false;\n      _this2.flvjs = flvjs;\n    }\n    return _ret = _this, (0, _possibleConstructorReturn3.default)(_this2, _ret);\n  }\n\n  (0, _createClass3.default)(flvAPI, [{\n    key: 'detachMedia',\n    value: function detachMedia() {\n      var player = this.flvPlayer;\n      if (player) {\n        this.pause();\n        this.detachEvent();\n        player.unload();\n        player.detachMediaElement();\n        player.destroy();\n        this.flvPlayer = null;\n        logger.success('Detach Media:', 'detach media for flv.js sucessfully.');\n      }\n      this.videoDOM.src = '';\n    }\n    //载入视频源，这里不可以用箭头函数\n\n  }, {\n    key: 'loadSource',\n    value: function loadSource(file) {\n      var flvjs = this.flvjs;\n      if (flvjs) {\n        var flvPlayer = flvjs.createPlayer({\n          type: 'flv',\n          url: file\n        }, (0, _extends3.default)({}, this.flvConfig));\n        this.flvPlayer = flvPlayer;\n        flvPlayer.attachMediaElement(this);\n        flvPlayer.load();\n        logger.info('Source Loading :', 'loading flv video.');\n        //flv的log事件是全局的，这是个坑\n        this.attachEvent();\n      }\n    }\n  }, {\n    key: 'detachEvent',\n    value: function detachEvent() {\n      if (this.LoggingControlListener && _const.DEBUG) {\n        this.flvjs.LoggingControl.removeLogListener(this.LoggingControlListener);\n      }\n    }\n  }, {\n    key: 'attachEvent',\n    value: function attachEvent() {\n      if (!_const.DEBUG) {\n        return;\n      }\n      // const locale = this.localization;\n      var errorTitle = 'Flv.js Error,';\n      if (this.flvjs) {\n        this.LoggingControlListener = function (type, str) {\n          if (type === 'error') {\n            // let message;\n            if (~str.indexOf('IOController')) {\n              logger.error(errorTitle, 'load error');\n              // message = locale.fileCouldNotPlay;\n              // //一般trigger都是为了对外提供api，error是个比较特殊的情况，寄对外提供了事件，也对内提供了事件。\n              // //如果只是对内不对外的话，不可以使用trigger处理事件，所有的都用redux。\n              // this.event.trigger('error', {\n              //   data: str,\n              //   message,\n              //   type,\n              // });\n            }\n          }\n        };\n\n        this.flvjs.LoggingControl.addLogListener(this.LoggingControlListener);\n      }\n    }\n  }]);\n  return flvAPI;\n}(_api2.default);\n\nexports.default = flvAPI;"]},"metadata":{},"sourceType":"script"}