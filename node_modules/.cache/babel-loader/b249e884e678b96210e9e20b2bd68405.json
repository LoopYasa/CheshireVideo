{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.namespace = undefined;\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nexports.default = function () {\n  //model支持方法，也支持纯对象，由于存在多个播放器，有作用域问题\n  //需要用到函数，函数返回的是纯对象，_api继承了整个video dom的对象，请参考src/api/api.js的说明。\n  var _initPayload = void 0;\n\n  var _api = void 0;\n\n  var _dispatch = void 0;\n\n  var _config = void 0; //controlbar 隐藏定时器\n\n\n  var _controlbarClearTimeout = void 0;\n\n  var fullscreenObj = void 0;\n  var loadingTimeout = void 0;\n  var showLoadingLazyTime = _const.SHOW_LOADING_LAZY_TIME;\n  var errorMessageTimeout = void 0;\n  var showErrorMessageLazyTime = _const.SHOW_ERROR_MESSAGE_LAZY_TIME;\n\n  var _videoEvents = void 0;\n\n  var subtitleList = void 0; //后续存放公共的一些state\n\n  var _state = {\n    retryReloadTime: 0,\n    lastCurrentTime: 0\n  };\n  var tempSeekingCurrentTime = void 0; //视频第一次播放,autoplay=false是，需要手动播放才算第一次播放\n  //只要触发了play就算首次播放，不需要视频成功播放（重连是属于播放器播放异常，每个实例化的播放器只有一次首次播放，重连不会重新计算）\n\n  var isFirstPlay = true; //是否是重连状态\n  //init函数运行完重置，不是根据dataloaded处理\n\n  var isReloading = false;\n\n  function getTracks() {\n    var _config2 = _config,\n        tracks = _config2.tracks;\n    subtitleList = []; //字幕，缩略图等\n\n    if (tracks) {\n      var i = 0;\n      tracks.forEach(function (v, k) {\n        if (v.kind === 'subtitle') {\n          subtitleList.push((0, _extends3.default)({}, v, {\n            name: v.label,\n            id: i\n          }));\n          i++;\n        } else if (v.kind === 'thumbnail') {\n          _dispatch({\n            type: _track.namespace + '/thumbnailSaga',\n            payload: v\n          });\n        }\n      });\n\n      _dispatch({\n        type: namespace + '/subtitleList',\n        payload: {\n          subtitleList: subtitleList,\n          subtitleId: -1\n        }\n      });\n    }\n  }\n\n  return {\n    namespace: namespace,\n    state: {\n      historyPercent: 0\n    },\n    reducers: {\n      clear: function clear(state, _ref) {\n        var payload = _ref.payload;\n        _videoEvents && _videoEvents.reset();\n\n        if (_api) {\n          _api.pause(); //移除事件监控\n\n\n          _api.off();\n\n          _api.detachMedia && _api.detachMedia(); //重置\n\n          _api.reset();\n        } //clear 正在setTimeout的定时器\n\n\n        _controlbarClearTimeout && _controlbarClearTimeout();\n        tempSeekingCurrentTime = undefined;\n        return this.state || {};\n      }\n    },\n    sagas: {\n      loading: /*#__PURE__*/_regenerator2.default.mark(function loading(_ref2, _ref3) {\n        var payload = _ref2.payload;\n        var put = _ref3.put;\n        var loading;\n        return _regenerator2.default.wrap(function loading$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                loading = payload.loading;\n                _api.loading = loading;\n\n                if (!(loading && _api.isError)) {\n                  _context.next = 4;\n                  break;\n                }\n\n                return _context.abrupt('return');\n\n              case 4:\n                clearTimeout(loadingTimeout);\n\n                if (!loading) {\n                  _context.next = 9;\n                  break;\n                }\n\n                loadingTimeout = setTimeout(function () {\n                  //使用setTimeout是为了防止视频很快就可以播放的情况，就不用展示loading。\n                  //否则就会对用户造成卡顿假像。\n                  _dispatch({\n                    type: _loading.namespace + '/setLoadingStateSaga',\n                    payload: payload\n                  });\n\n                  logger.info('Loading Video:', 'video is not enough to be played');\n\n                  _api.trigger('loading', loading);\n                }, showLoadingLazyTime);\n                _context.next = 13;\n                break;\n\n              case 9:\n                _context.next = 11;\n                return put({\n                  type: _loading.namespace + '/setLoadingStateSaga',\n                  payload: payload\n                });\n\n              case 11:\n                logger.info('Hide Loading:', 'video is enough to be played');\n\n                _api.trigger('loading', loading);\n\n              case 13:\n                if (!_api.isError) {\n                  _context.next = 16;\n                  break;\n                }\n\n                _context.next = 16;\n                return {\n                  type: namespace + '/errorMessage',\n                  payload: {\n                    message: null\n                  }\n                };\n\n              case 16:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, loading, this);\n      }),\n      playAfterNotAutoplay: /*#__PURE__*/_regenerator2.default.mark(function playAfterNotAutoplay(_ref4, _ref5) {\n        var payload = _ref4.payload;\n        var put = _ref5.put;\n        return _regenerator2.default.wrap(function playAfterNotAutoplay$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (_api.playing) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                if (!_config.preload) {\n                  //autoplay=false,preload=false\n                  _api.loadSource(_config.file);\n\n                  getTracks();\n                }\n\n                _context2.next = 4;\n                return put({\n                  type: 'controlbar',\n                  payload: true\n                });\n\n              case 4:\n                _context2.next = 6;\n                return put({\n                  type: 'play'\n                });\n\n              case 6:\n                //autoplay=flase时需要再手动播放后运行\n                _videoEvents = (0, _events2.default)(_initPayload, isFirstPlay, _state);\n                isFirstPlay = false;\n\n              case 8:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, playAfterNotAutoplay, this);\n      }),\n      hideNotAutoPlayView: /*#__PURE__*/_regenerator2.default.mark(function hideNotAutoPlayView(_ref6, _ref7) {\n        var payload = _ref6.payload;\n        var put = _ref7.put;\n        return _regenerator2.default.wrap(function hideNotAutoPlayView$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                logger.info('Hide Not Auto Play View');\n                _context3.next = 3;\n                return put({\n                  type: _notAutoplay.namespace + '/notAutoPlayStateSaga',\n                  payload: false\n                });\n\n              case 3:\n                _api.notAutoPlayViewHide = true;\n\n              case 4:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, hideNotAutoPlayView, this);\n      }),\n      play: /*#__PURE__*/_regenerator2.default.mark(function play(_ref8, _ref9) {\n        var payload = _ref8.payload;\n        var put = _ref9.put;\n        return _regenerator2.default.wrap(function play$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!_api.isError) {\n                  _context4.next = 2;\n                  break;\n                }\n\n                return _context4.abrupt('return');\n\n              case 2:\n                if (_api.notAutoPlayViewHide) {\n                  _context4.next = 5;\n                  break;\n                }\n\n                _context4.next = 5;\n                return put({\n                  type: 'hideNotAutoPlayView'\n                });\n\n              case 5:\n                if (!_api.ended) {\n                  _context4.next = 12;\n                  break;\n                } //重新播放\n                //重置\n\n\n                _api.reset(); //如果已经播放结束，重新播放需要隐藏重新播放按钮\n\n\n                _context4.next = 9;\n                return put({\n                  type: 'end',\n                  payload: false\n                });\n\n              case 9:\n                _context4.next = 11;\n                return put({\n                  type: 'time',\n                  payload: {\n                    currentTime: 0,\n                    duration: _api.duration\n                  }\n                });\n\n              case 11:\n                _api.trigger('replay');\n\n              case 12:\n                _api.play();\n\n                logger.info('Play Action', 'start playing');\n                _context4.next = 16;\n                return put({\n                  type: _playPause.namespace + '/playPauseSaga',\n                  payload: true\n                });\n\n              case 16:\n                if (_api.bufferTime) {\n                  _context4.next = 21;\n                  break;\n                }\n\n                _context4.next = 19;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: true\n                  }\n                });\n\n              case 19:\n                _context4.next = 24;\n                break;\n\n              case 21:\n                if (!(!_api.loading && _api.bufferTime < _api.currentTime || //readyState < 3代表视频就绪状态不足以播放。\n                _api.readyState < 3)) {\n                  _context4.next = 24;\n                  break;\n                }\n\n                _context4.next = 24;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: true\n                  }\n                });\n\n              case 24:\n                if (!(!payload || payload && !payload.noControlbarAction)) {\n                  _context4.next = 29;\n                  break;\n                }\n\n                _context4.next = 27;\n                return put({\n                  type: 'controlbarClearTimeout'\n                });\n\n              case 27:\n                _context4.next = 29;\n                return put({\n                  type: 'controlbar',\n                  payload: false,\n                  delayTime: _config.controlbarHideTime\n                });\n\n              case 29:\n              case 'end':\n                return _context4.stop();\n            }\n          }\n        }, play, this);\n      }),\n      pause: /*#__PURE__*/_regenerator2.default.mark(function pause(_ref10, _ref11) {\n        var payload = _ref10.payload;\n        var put = _ref11.put;\n        return _regenerator2.default.wrap(function pause$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (!_api.isError) {\n                  _context5.next = 2;\n                  break;\n                }\n\n                return _context5.abrupt('return');\n\n              case 2:\n                logger.info('Pause Action', 'start pause');\n\n                _api.pause();\n\n                if (_api.playing) {\n                  _context5.next = 14;\n                  break;\n                }\n\n                _context5.next = 7;\n                return put({\n                  type: _playPause.namespace + '/playPauseSaga',\n                  payload: false\n                });\n\n              case 7:\n                if (!_api.loading) {\n                  _context5.next = 10;\n                  break;\n                }\n\n                _context5.next = 10;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: false\n                  }\n                });\n\n              case 10:\n                _context5.next = 12;\n                return put({\n                  type: 'controlbarClearTimeout'\n                });\n\n              case 12:\n                _context5.next = 14;\n                return put({\n                  type: 'controlbar',\n                  payload: true\n                });\n\n              case 14:\n              case 'end':\n                return _context5.stop();\n            }\n          }\n        }, pause, this);\n      }),\n      volume: /*#__PURE__*/_regenerator2.default.mark(function volume(_ref12, _ref13) {\n        var _ref12$payload = _ref12.payload,\n            payload = _ref12$payload === undefined ? 0 : _ref12$payload;\n        var put = _ref13.put;\n        var volume, realVideoVolume;\n        return _regenerator2.default.wrap(function volume$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                volume = payload;\n\n                if (isNaN(volume)) {\n                  //错误兼容处理\n                  volume = 0;\n                }\n\n                storage.set('volume', volume); //转换成真实的video声音值，原生的video声音范围为[0,1]。\n\n                realVideoVolume = volume / _const.MAX_VOLUME * 1;\n\n                _api.setVolume(realVideoVolume);\n\n                _context6.next = 7;\n                return put({\n                  type: _volume.namespace + '/dataSaga',\n                  payload: payload\n                });\n\n              case 7:\n                _api.trigger('volume', volume);\n\n                logger.info('Set Volume', 'set volume to ' + volume.toFixed(2) + ',the max volume is 100.');\n\n              case 9:\n              case 'end':\n                return _context6.stop();\n            }\n          }\n        }, volume, this);\n      }),\n      muted: /*#__PURE__*/_regenerator2.default.mark(function muted(_ref14, _ref15) {\n        var _ref14$payload = _ref14.payload,\n            payload = _ref14$payload === undefined ? false : _ref14$payload,\n            _ref14$autoMuted = _ref14.autoMuted,\n            autoMuted = _ref14$autoMuted === undefined ? false : _ref14$autoMuted;\n        var put = _ref15.put;\n        var muted;\n        return _regenerator2.default.wrap(function muted$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                muted = payload;\n\n                if (!autoMuted) {\n                  storage.set('muted', muted);\n                }\n\n                _api.muted = muted;\n                _context7.next = 5;\n                return put({\n                  type: _muted.namespace + '/dataSaga',\n                  payload: payload\n                });\n\n              case 5:\n                if (!muted) {\n                  _context7.next = 8;\n                  break;\n                }\n\n                _context7.next = 8;\n                return put({\n                  type: _volume.namespace + '/dataSaga',\n                  payload: 0\n                });\n\n              case 8:\n                _api.trigger('muted', muted);\n\n                if (muted) {\n                  logger.info('Set Muted', 'set video muted ');\n                } else {\n                  logger.info('Cancel Muted', 'cancel video muted ');\n                }\n\n              case 10:\n              case 'end':\n                return _context7.stop();\n            }\n          }\n        }, muted, this);\n      }),\n      end: /*#__PURE__*/_regenerator2.default.mark(function end(_ref16, _ref17) {\n        var payload = _ref16.payload;\n        var put = _ref17.put;\n        return _regenerator2.default.wrap(function end$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _context8.next = 2;\n                return put({\n                  type: 'pause'\n                });\n\n              case 2:\n                if (!_api.loading) {\n                  _context8.next = 5;\n                  break;\n                }\n\n                _context8.next = 5;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: false\n                  }\n                });\n\n              case 5:\n                _context8.next = 7;\n                return put({\n                  type: _end3.namespace + '/endStateSaga',\n                  payload: payload\n                });\n\n              case 7:\n                _context8.next = 9;\n                return put({\n                  type: 'controlbar',\n                  payload: true,\n                  onControlbarEnter: false\n                });\n\n              case 9:\n                _context8.next = 11;\n                return put({\n                  type: 'time',\n                  payload: {\n                    currentTime: _api.ended ? _api.duration : _api.currentTime,\n                    duration: _api.duration\n                  }\n                });\n\n              case 11:\n              case 'end':\n                return _context8.stop();\n            }\n          }\n        }, end, this);\n      }),\n      replay: /*#__PURE__*/_regenerator2.default.mark(function replay(_ref18, _ref19) {\n        var payload = _ref18.payload;\n        var put = _ref19.put;\n        return _regenerator2.default.wrap(function replay$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.next = 2;\n                return put({\n                  type: 'time',\n                  payload: {\n                    currentTime: 0,\n                    duration: 0\n                  }\n                });\n\n              case 2:\n                _context9.next = 4;\n                return put({\n                  type: 'end',\n                  payload: false\n                });\n\n              case 4:\n                _context9.next = 6;\n                return put({\n                  type: 'play'\n                });\n\n              case 6:\n                logger.info('Replay', 'replay video when video is ended.');\n\n              case 7:\n              case 'end':\n                return _context9.stop();\n            }\n          }\n        }, replay, this);\n      }),\n      time: /*#__PURE__*/_regenerator2.default.mark(function time(_ref20, _ref21) {\n        var payload = _ref20.payload;\n        var put = _ref21.put,\n            select = _ref21.select;\n        var reduxStore, fragment;\n        return _regenerator2.default.wrap(function time$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                if (!(_api.isError && !_api.living)) {\n                  _context10.next = 5;\n                  break;\n                }\n\n                _context10.next = 3;\n                return put({\n                  type: 'errorMessage',\n                  payload: {\n                    message: null\n                  }\n                });\n\n              case 3:\n                _context10.next = 5;\n                return put({\n                  type: 'play'\n                });\n\n              case 5:\n                _context10.next = 7;\n                return select();\n\n              case 7:\n                reduxStore = _context10.sent;\n                fragment = reduxStore.fragment;\n                _context10.next = 11;\n                return put({\n                  type: _time.namespace + '/timeSaga',\n                  payload: (0, _extends3.default)({}, payload, {\n                    duration: fragment && fragment.duration || payload.duration,\n                    currentTime: payload.currentTime + (payload.currentTime === 0 ? 0 : _api.videoGaps)\n                  })\n                });\n\n              case 11:\n                if (!(!fragment || !fragment.data)) {\n                  _context10.next = 16;\n                  break;\n                }\n\n                _context10.next = 14;\n                return put({\n                  type: _timeSlider.namespace + '/timeSaga',\n                  payload: (0, _extends3.default)({\n                    buffer: _api.bufferTime\n                  }, payload)\n                });\n\n              case 14:\n                _context10.next = 18;\n                break;\n\n              case 16:\n                _context10.next = 18;\n                return put({\n                  type: 'fragment'\n                });\n\n              case 18:\n              case 'end':\n                return _context10.stop();\n            }\n          }\n        }, time, this);\n      }),\n      //合成录像，摄像头上传视频会中断，会分成几个视频，然后这几个视频会合并成一个视频\n      //但是这个视频不是整个时段的，会有断的，为了给用户知道这段录像哪里断了，需要而外处理\n      //这里是为了算出播放中，遇到断片的情况，进行一些跳过处理\n      fragment: /*#__PURE__*/_regenerator2.default.mark(function fragment(_ref22, _ref23) {\n        var _ref22$payload = _ref22.payload,\n            payload = _ref22$payload === undefined ? {} : _ref22$payload;\n        var put = _ref23.put,\n            select = _ref23.select;\n        var reduxStore, fragment, fragmentDuration, fragmentData, selection, selectionBeginPercent, sliderPercent, seeking, percent, position, gapPosition;\n        return _regenerator2.default.wrap(function fragment$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return select();\n\n              case 2:\n                reduxStore = _context11.sent;\n                fragment = reduxStore.fragment;\n\n                if (!(!fragment || !fragment.data)) {\n                  _context11.next = 6;\n                  break;\n                }\n\n                return _context11.abrupt('return');\n\n              case 6:\n                _api.fragmentDuration = fragment.duration;\n\n                if (_api.currentTime === 0) {\n                  //循环播放会重头放，需要重置\n                  _api.videoGaps = 0;\n                }\n\n                fragmentDuration = fragment.duration, fragmentData = fragment.data; //begin----处理selection\n\n                selection = reduxStore.selection;\n                selectionBeginPercent = void 0;\n\n                if (!(_config.selection && !_config.isHistory)) {\n                  _context11.next = 18;\n                  break;\n                } //history是fragment的另一版本，多个视频，fragment是一个视频\n\n\n                if (selection.end > fragment.duration) {\n                  selection.end = fragment.duration;\n                }\n\n                if (!(_api.currentTime + _api.videoGaps < selection.begin || _api.currentTime + _api.videoGaps > selection.end)) {\n                  _context11.next = 18;\n                  break;\n                }\n\n                if (!(_api.notAutoPlayViewHide && !_config.autoplay)) {\n                  _context11.next = 17;\n                  break;\n                }\n\n                _context11.next = 17;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: true\n                  }\n                });\n\n              case 17:\n                selectionBeginPercent = selection.begin / fragment.duration;\n\n              case 18:\n                //end----处理selection\n                sliderPercent = 0;\n                seeking = payload.seeking, percent = payload.percent;\n\n                if (seeking || selectionBeginPercent) {\n                  position = (selectionBeginPercent || percent) * fragmentDuration; //如果是点击、拖拽\n\n                  _api.videoGaps = 0;\n                  fragmentData.forEach(function (v) {\n                    if (position >= v.begin) {\n                      _api.videoGaps = v.gaps;\n                    }\n\n                    if (position >= v.begin && position < v.end) {\n                      position = v.begin + v.gap;\n                    }\n                  });\n                  sliderPercent = selectionBeginPercent || percent;\n                  tempSeekingCurrentTime = position - _api.videoGaps;\n                } else {\n                  gapPosition = _api.currentTime + _api.videoGaps;\n                  fragmentData.forEach(function (v, k) {\n                    if (gapPosition >= v.begin && gapPosition < v.end) {\n                      for (var i = 0; i <= k; i++) {\n                        _api.videoGaps = fragmentData[i].gaps;\n                      }\n                    }\n                  });\n                  sliderPercent = (_api.currentTime + _api.videoGaps) / fragmentDuration;\n                }\n\n                if (sliderPercent > 1 || _api.ended) {\n                  sliderPercent = 1;\n                }\n\n                _context11.next = 24;\n                return put({\n                  type: _fragment.namespace + '/sliderReducer',\n                  payload: {\n                    percent: sliderPercent\n                  }\n                });\n\n              case 24:\n              case 'end':\n                return _context11.stop();\n            }\n          }\n        }, fragment, this);\n      }),\n      //是否在seeking\n      seekingState: /*#__PURE__*/_regenerator2.default.mark(function seekingState(_ref24, _ref25) {\n        var payload = _ref24.payload;\n        var put = _ref25.put,\n            select = _ref25.select;\n        return _regenerator2.default.wrap(function seekingState$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                if (!_api.ended) {\n                  _context12.next = 2;\n                  break;\n                }\n\n                return _context12.abrupt('return');\n\n              case 2:\n                if (payload) {\n                  logger.info('Start seeking');\n                } else {\n                  logger.info('Stop seeking');\n                }\n\n                _api.seekingState = payload;\n\n                if (payload && _api.playing) {\n                  _api.pause();\n                }\n\n                if (payload) {\n                  _context12.next = 13;\n                  break;\n                }\n\n                if (tempSeekingCurrentTime !== undefined) {\n                  _api.currentTime = tempSeekingCurrentTime;\n                } //seeking结束后，都播放视频。\n\n\n                if (_api.playing) {\n                  _context12.next = 12;\n                  break;\n                }\n\n                _context12.next = 10;\n                return put({\n                  type: 'play'\n                });\n\n              case 10:\n                _context12.next = 13;\n                break;\n\n              case 12:\n                _api.play();\n\n              case 13:\n              case 'end':\n                return _context12.stop();\n            }\n          }\n        }, seekingState, this);\n      }),\n      seeking: /*#__PURE__*/_regenerator2.default.mark(function seeking(_ref26, _ref27) {\n        var _ref26$payload = _ref26.payload,\n            _ref26$payload$percen = _ref26$payload.percent,\n            percent = _ref26$payload$percen === undefined ? 0 : _ref26$payload$percen,\n            pause = _ref26$payload.pause;\n        var put = _ref27.put,\n            select = _ref27.select;\n        var reduxStore, fragment;\n        return _regenerator2.default.wrap(function seeking$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                if (!(_api.readyState < 1 || isFirstPlay)) {\n                  _context13.next = 2;\n                  break;\n                }\n\n                return _context13.abrupt('return');\n\n              case 2:\n                if (!_api.ended) {\n                  _context13.next = 5;\n                  break;\n                }\n\n                _context13.next = 5;\n                return put({\n                  type: 'end',\n                  payload: false\n                });\n\n              case 5:\n                _context13.next = 7;\n                return select();\n\n              case 7:\n                reduxStore = _context13.sent;\n                fragment = reduxStore.fragment;\n\n                if (!(!fragment || !fragment.data)) {\n                  _context13.next = 15;\n                  break;\n                }\n\n                tempSeekingCurrentTime = _api.duration * percent;\n                _context13.next = 13;\n                return put({\n                  type: _timeSlider.namespace + '/timeSaga',\n                  payload: {\n                    buffer: _api.bufferTime,\n                    currentTime: _api.duration * percent,\n                    duration: _api.duration\n                  }\n                });\n\n              case 13:\n                _context13.next = 17;\n                break;\n\n              case 15:\n                _context13.next = 17;\n                return put({\n                  type: 'fragment',\n                  payload: {\n                    seeking: true,\n                    percent: percent\n                  }\n                });\n\n              case 17:\n                _api.trigger('seek', percent);\n\n              case 18:\n              case 'end':\n                return _context13.stop();\n            }\n          }\n        }, seeking, this);\n      }),\n      selection: /*#__PURE__*/_regenerator2.default.mark(function selection(_ref28, _ref29) {\n        var _ref28$payload = _ref28.payload,\n            percent = _ref28$payload.percent,\n            type = _ref28$payload.type,\n            duration = _ref28$payload.duration;\n        var put = _ref29.put,\n            select = _ref29.select;\n\n        var reduxStore, fragment, selection, begin, _begin, _end, _end2;\n\n        return _regenerator2.default.wrap(function selection$(_context14) {\n          while (1) {\n            switch (_context14.prev = _context14.next) {\n              case 0:\n                _context14.next = 2;\n                return select();\n\n              case 2:\n                reduxStore = _context14.sent;\n                fragment = reduxStore.fragment;\n                selection = reduxStore.selection;\n\n                if (!duration) {\n                  duration = fragment.duration;\n                }\n\n                if (selection.end > duration) {\n                  selection.end = duration;\n                }\n\n                if (!(type === 'left-blur')) {\n                  _context14.next = 15;\n                  break;\n                }\n\n                if (_config.isHistory) {\n                  _context14.next = 11;\n                  break;\n                }\n\n                _context14.next = 11;\n                return put({\n                  type: 'seeking',\n                  payload: {\n                    percent: percent\n                  }\n                });\n\n              case 11:\n                begin = percent * duration; //对外提供selection事件\n\n                _api.trigger('selection', (0, _extends3.default)({}, selection, {\n                  begin: begin\n                }));\n\n                _context14.next = 32;\n                break;\n\n              case 15:\n                if (!(type === 'left-change')) {\n                  _context14.next = 23;\n                  break;\n                }\n\n                _begin = percent * duration;\n\n                if (_begin > selection.end - selection.minGap) {\n                  _begin = selection.end - selection.minGap;\n\n                  if (selection.end < selection.minGap) {\n                    _begin = 0;\n                  }\n                }\n\n                if (selection.end - _begin > selection.maxGap) {\n                  _begin = selection.end - selection.maxGap;\n                }\n\n                _context14.next = 21;\n                return put({\n                  type: _selection.namespace + '/dataReducer',\n                  payload: (0, _extends3.default)({}, selection, {\n                    begin: _begin\n                  })\n                });\n\n              case 21:\n                _context14.next = 32;\n                break;\n\n              case 23:\n                if (!(type === 'right-change')) {\n                  _context14.next = 31;\n                  break;\n                }\n\n                _end = percent * duration;\n\n                if (selection.begin > _end - selection.minGap) {\n                  _end = selection.begin + selection.minGap;\n\n                  if (selection.end < selection.minGap) {\n                    _end = duration;\n                  }\n                }\n\n                if (_end - selection.begin > selection.maxGap) {\n                  _end = selection.maxGap + selection.begin;\n                }\n\n                _context14.next = 29;\n                return put({\n                  type: _selection.namespace + '/dataReducer',\n                  payload: (0, _extends3.default)({}, selection, {\n                    end: _end\n                  })\n                });\n\n              case 29:\n                _context14.next = 32;\n                break;\n\n              case 31:\n                if (type === 'right-blur') {\n                  _end2 = percent * duration; //对外提供selection事件\n\n                  _api.trigger('selection', (0, _extends3.default)({}, selection, {\n                    end: _end2\n                  }));\n                }\n\n              case 32:\n              case 'end':\n                return _context14.stop();\n            }\n          }\n        }, selection, this);\n      }),\n      fullscreen: /*#__PURE__*/_regenerator2.default.mark(function fullscreen(_ref30, _ref31) {\n        var payload = _ref30.payload;\n        var put = _ref31.put;\n        var fullscreenDom;\n        return _regenerator2.default.wrap(function fullscreen$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                if (fullscreenObj) {\n                  fullscreenObj.remove();\n                }\n\n                fullscreenDom = _api.parentNode.parentNode;\n                fullscreenObj = new _fullscreen3.default(fullscreenDom, _api.ownerDocument, function () {\n                  var isFull = fullscreenObj.fullscreenElement();\n\n                  if (isFull) {\n                    fullscreenDom.style.width = '100%';\n                    fullscreenDom.style.display = 'block';\n                    fullscreenDom.style.height = '100%';\n                  } else {\n                    fullscreenDom.style.width = '';\n                    fullscreenDom.style.display = '';\n                    fullscreenDom.style.height = '';\n                  }\n\n                  _api.trigger('fullscreen', !!isFull);\n\n                  if (isFull) {\n                    logger.info('Fullscreen');\n                  } else {\n                    logger.info('Fullscreen exited');\n                  }\n\n                  _dispatch({\n                    type: _fullscreen.namespace + '/fullscreenSaga',\n                    payload: !!isFull\n                  });\n\n                  if (!isFull) {\n                    //非全屏，移除监听器。\n                    fullscreenObj.remove();\n                    fullscreenObj = null;\n                  }\n                });\n\n                if (fullscreenObj.supportsDomFullscreen) {\n                  if (payload) {\n                    fullscreenObj.requestFullscreen();\n                  } else {\n                    fullscreenObj.exitFullscreen();\n                  }\n                } else {//异常处理\n                }\n\n                if (!_api.playing) {\n                  _context15.next = 7;\n                  break;\n                }\n\n                _context15.next = 7;\n                return put({\n                  type: 'controlbar',\n                  payload: false,\n                  delayTime: _config.controlbarHideTime,\n                  onControlbarEnter: false\n                });\n\n              case 7:\n              case 'end':\n                return _context15.stop();\n            }\n          }\n        }, fullscreen, this);\n      }),\n      controlbarClearTimeout: function controlbarClearTimeout(_ref32) {\n        var payload = _ref32.payload;\n\n        if (payload && payload.onControlbarEnter !== undefined) {\n          _api.onControlbarEnter = payload.onControlbarEnter;\n        }\n\n        _controlbarClearTimeout && _controlbarClearTimeout();\n      },\n      controlbar: /*#__PURE__*/_regenerator2.default.mark(function controlbar(_ref33, _ref34) {\n        var payload = _ref33.payload,\n            delayTime = _ref33.delayTime,\n            onControlbarEnter = _ref33.onControlbarEnter;\n        var put = _ref34.put;\n        var flag, delayPromise;\n        return _regenerator2.default.wrap(function controlbar$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n                _context16.next = 2;\n                return put({\n                  type: 'controlbarClearTimeout'\n                });\n\n              case 2:\n                if (!(_api.isError && !payload)) {\n                  _context16.next = 4;\n                  break;\n                }\n\n                return _context16.abrupt('return');\n\n              case 4:\n                if (onControlbarEnter !== undefined) {\n                  _api.onControlbarEnter = onControlbarEnter;\n                }\n\n                if (_api.onControlbarEnter) {\n                  //如果正在controlbar上，强制controlbar显示\n                  payload = true;\n                }\n\n                flag = true; //controlbar隐藏时，delay才有效，显示controlbar是立刻显示\n\n                if (!(delayTime && !payload)) {\n                  _context16.next = 13;\n                  break;\n                }\n\n                delayPromise = util.delay(delayTime);\n                _controlbarClearTimeout = delayPromise.clearTimeout;\n                _context16.next = 12;\n                return delayPromise;\n\n              case 12:\n                flag = _context16.sent;\n\n              case 13:\n                if (!flag) {\n                  _context16.next = 18;\n                  break;\n                }\n\n                if (payload) {\n                  _api.controlbarShow = true;\n                  logger.info('Controlbar show');\n                } else {\n                  _api.controlbarShow = false;\n                  logger.info('Controlbar hide');\n                }\n\n                _context16.next = 17;\n                return put({\n                  type: _controlbar.namespace + '/controlbarSaga',\n                  payload: payload\n                });\n\n              case 17:\n                //对外提供controlbar事件\n                _api.trigger('controlbar', payload);\n\n              case 18:\n              case 'end':\n                return _context16.stop();\n            }\n          }\n        }, controlbar, this);\n      }),\n      errorMessage: function errorMessage(_ref35, _ref36) {\n        var payload = _ref35.payload;\n        var put = _ref36.put;\n        clearTimeout(errorMessageTimeout);\n\n        if (_api.ended) {\n          return;\n        }\n\n        var error = function error() {\n          //先清除，可能遗留的\n          _dispatch({\n            type: namespace + '/controlbarClearTimeout'\n          });\n\n          if (!_api.controlbarShow) {\n            _dispatch({\n              type: namespace + '/controlbar',\n              payload: true,\n              onControlbarEnter: false\n            });\n          }\n\n          if (!_api.notAutoPlayViewHide) {\n            //如果not-autoplay页面没关闭\n            _dispatch({\n              type: namespace + '/hideNotAutoPlayView'\n            });\n          }\n\n          _dispatch({\n            type: _errorMessage.namespace + '/errorMessageSaga',\n            payload: payload\n          }); // 把播放暂停显示按钮显示为暂停。\n\n\n          _dispatch({\n            type: _playPause.namespace + '/playPauseSaga',\n            payload: false\n          });\n        };\n\n        if (payload.message) {\n          errorMessageTimeout = setTimeout(function () {\n            _api.isError = true; //使用setTimeout是为了防止视频很快就可以播放的情况，就不用展示loading。\n            //否则就会对用户造成卡顿假像。\n\n            logger.info('Error message show');\n\n            if (_api.loading) {\n              //如果还有loading，需要隐藏\n              _dispatch({\n                type: namespace + '/loading',\n                payload: {\n                  loading: false\n                }\n              });\n            }\n\n            _dispatch({\n              type: namespace + '/pause'\n            });\n\n            error();\n          }, showErrorMessageLazyTime);\n        } else {\n          logger.info('Error message hide');\n          error(); //如果非错误，需要设置_api.isError为false\n\n          _api.isError = false;\n        }\n      },\n      reload: /*#__PURE__*/_regenerator2.default.mark(function reload(_ref37, _ref38) {\n        var payload = _ref37.payload;\n        var put = _ref38.put;\n        var retryReloadTime;\n        return _regenerator2.default.wrap(function reload$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n                logger.info('Reload Video'); //报错保存之前的播放进度\n\n                if (!_state.lastCurrentTime) {\n                  _state.lastCurrentTime = _api.currentTime;\n                }\n\n                retryReloadTime = 1;\n\n                if (payload) {\n                  retryReloadTime = payload.retryReloadTime;\n                }\n\n                isReloading = true;\n\n                _api.trigger('reload'); //重置\n\n\n                _api.reset();\n\n                _api.detachMedia && _api.detachMedia();\n                _videoEvents && _videoEvents.reset();\n                _context17.next = 11;\n                return put({\n                  type: 'errorMessage',\n                  payload: {\n                    message: null\n                  }\n                });\n\n              case 11:\n                _context17.next = 13;\n                return put({\n                  type: 'controlbar',\n                  payload: false\n                });\n\n              case 13:\n                _context17.next = 15;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: true,\n                    message: _config.localization.reloading,\n                    retryReloadTime: retryReloadTime,\n                    type: 'reload'\n                  }\n                });\n\n              case 15:\n                _config.reload(function () {\n                  _api.reloading = true;\n                  _api.isError = false;\n                });\n\n              case 16:\n              case 'end':\n                return _context17.stop();\n            }\n          }\n        }, reload, this);\n      }),\n      living: /*#__PURE__*/_regenerator2.default.mark(function living(_ref39, _ref40) {\n        var duration = _ref39.payload.duration;\n        var put = _ref40.put;\n        var living;\n        return _regenerator2.default.wrap(function living$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n                living = false;\n\n                if (duration === Infinity || isNaN(duration)) {\n                  living = true;\n                }\n\n                if (living) {\n                  logger.info('Living', 'the video is a living video.');\n                }\n\n                _api.living = living;\n                _context18.next = 6;\n                return put({\n                  type: _living.namespace + '/setLivingSaga',\n                  payload: living\n                });\n\n              case 6:\n              case 'end':\n                return _context18.stop();\n            }\n          }\n        }, living, this);\n      }),\n      playbackRate: /*#__PURE__*/_regenerator2.default.mark(function playbackRate(_ref41, _ref42) {\n        var _playbackRate = _ref41.payload;\n        var put = _ref42.put;\n        return _regenerator2.default.wrap(function playbackRate$(_context19) {\n          while (1) {\n            switch (_context19.prev = _context19.next) {\n              case 0:\n                logger.info('PlaybackRate switched');\n                _api.playbackRate = _playbackRate;\n                _context19.next = 4;\n                return put({\n                  type: _playbackRate2.namespace + '/setPlaybackRateSaga',\n                  payload: _playbackRate\n                });\n\n              case 4:\n              case 'end':\n                return _context19.stop();\n            }\n          }\n        }, playbackRate, this);\n      }),\n      subtitleList: /*#__PURE__*/_regenerator2.default.mark(function subtitleList(_ref43, _ref44) {\n        var payload = _ref43.payload;\n        var put = _ref44.put;\n        return _regenerator2.default.wrap(function subtitleList$(_context20) {\n          while (1) {\n            switch (_context20.prev = _context20.next) {\n              case 0:\n                logger.info('Subtitle List showed');\n                _context20.next = 3;\n                return put({\n                  type: _track.namespace + '/subtitleListSaga',\n                  payload: payload\n                });\n\n              case 3:\n              case 'end':\n                return _context20.stop();\n            }\n          }\n        }, subtitleList, this);\n      }),\n      switchSubtitle: /*#__PURE__*/_regenerator2.default.mark(function switchSubtitle(_ref45, _ref46) {\n        var payload = _ref45.payload;\n        var put = _ref46.put;\n        var i;\n        return _regenerator2.default.wrap(function switchSubtitle$(_context21) {\n          while (1) {\n            switch (_context21.prev = _context21.next) {\n              case 0:\n                //存储状态\n                _api.currentSubtitleTrack = payload; //end----textTracks状态处理\n\n                if (!_api.hlsObj) {\n                  _context21.next = 5;\n                  break;\n                } //hls.js解析的hls自带字幕\n                //hls.js切换方式就是这样。\n\n\n                _api.hlsObj.subtitleTrack = payload;\n                _context21.next = 17;\n                break;\n\n              case 5:\n                if (!(_api.textTracks.length > 0)) {\n                  _context21.next = 10;\n                  break;\n                } //浏览器原生解析的hls自带字幕\n                //begin----textTracks状态处理\n\n\n                for (i = 0; i < _api.textTracks.length; i++) {\n                  _api.textTracks[i].mode = 'disabled';\n                }\n\n                if (_api.textTracks[payload]) {\n                  //关闭不用处理\n                  _api.textTracks[payload].mode = 'hidden';\n                }\n\n                _context21.next = 17;\n                break;\n\n              case 10:\n                if (!(subtitleList && subtitleList[payload])) {\n                  _context21.next = 15;\n                  break;\n                }\n\n                _context21.next = 13;\n                return put({\n                  type: _track.namespace + '/subtitleCuesSaga',\n                  payload: {\n                    subtitleId: payload,\n                    file: subtitleList[payload].file\n                  }\n                });\n\n              case 13:\n                _context21.next = 17;\n                break;\n\n              case 15:\n                _context21.next = 17;\n                return put({\n                  type: _track.namespace + '/subtitleCuesSaga',\n                  payload: {\n                    subtitleId: payload\n                  }\n                });\n\n              case 17:\n                _context21.next = 19;\n                return put({\n                  type: _track.namespace + '/subtitleListSaga',\n                  payload: {\n                    subtitleId: payload\n                  }\n                });\n\n              case 19:\n              case 'end':\n                return _context21.stop();\n            }\n          }\n        }, switchSubtitle, this);\n      }),\n      hlsSubtitleCues: /*#__PURE__*/_regenerator2.default.mark(function hlsSubtitleCues(_ref47, _ref48) {\n        var payload = _ref47.payload;\n        var put = _ref48.put;\n        var cues, k, v;\n        return _regenerator2.default.wrap(function hlsSubtitleCues$(_context22) {\n          while (1) {\n            switch (_context22.prev = _context22.next) {\n              case 0:\n                cues = [];\n\n                for (k = 0; k < payload.length; k++) {\n                  v = payload[k];\n                  cues.push({\n                    begin: v.startTime,\n                    end: v.endTime,\n                    text: v.text\n                  });\n                }\n\n                _context22.next = 4;\n                return put({\n                  type: _track.namespace + '/hlsSubtitleCuesSaga',\n                  payload: cues\n                });\n\n              case 4:\n              case 'end':\n                return _context22.stop();\n            }\n          }\n        }, hlsSubtitleCues, this);\n      }),\n      pictureQualityList: /*#__PURE__*/_regenerator2.default.mark(function pictureQualityList(_ref49, _ref50) {\n        var payload = _ref49.payload;\n        var put = _ref50.put;\n        return _regenerator2.default.wrap(function pictureQualityList$(_context23) {\n          while (1) {\n            switch (_context23.prev = _context23.next) {\n              case 0:\n                _context23.next = 2;\n                return put({\n                  type: _pictureQuality.namespace + '/dataSaga',\n                  payload: payload\n                });\n\n              case 2:\n              case 'end':\n                return _context23.stop();\n            }\n          }\n        }, pictureQualityList, this);\n      }),\n      switchPictureQuality: /*#__PURE__*/_regenerator2.default.mark(function switchPictureQuality(_ref51, _ref52) {\n        var payload = _ref51.payload;\n        var put = _ref52.put;\n        return _regenerator2.default.wrap(function switchPictureQuality$(_context24) {\n          while (1) {\n            switch (_context24.prev = _context24.next) {\n              case 0:\n                if (_api.hlsObj) {\n                  //hls.js切换画质\n                  _api.hlsObj.nextLevel = payload;\n                }\n\n                _context24.next = 3;\n                return put({\n                  type: _pictureQuality.namespace + '/dataSaga',\n                  payload: {\n                    currentQuality: payload\n                  }\n                });\n\n              case 3:\n              case 'end':\n                return _context24.stop();\n            }\n          }\n        }, switchPictureQuality, this);\n      }),\n      rotate: /*#__PURE__*/_regenerator2.default.mark(function rotate(_ref53, _ref54) {\n        var payload = _ref53.payload;\n        var put = _ref54.put;\n        var width, height;\n        return _regenerator2.default.wrap(function rotate$(_context25) {\n          while (1) {\n            switch (_context25.prev = _context25.next) {\n              case 0:\n                _context25.next = 2;\n                return put({\n                  type: _rotate.namespace + '/dataSaga',\n                  payload: payload\n                });\n\n              case 2:\n                width = _api.clientWidth;\n                height = _api.clientHeight;\n                _api.style.transform = 'rotate(-' + payload + 'deg)';\n\n                if (payload === 90 || payload === 270) {\n                  _api.style.width = height + 'px';\n                  _api.style.marginLeft = width / 2 - height / 2 + 'px';\n                } else {\n                  _api.style.width = '';\n                  _api.style.marginLeft = '';\n                }\n\n              case 6:\n              case 'end':\n                return _context25.stop();\n            }\n          }\n        }, rotate, this);\n      }),\n      setHistoryCurrentTime: function setHistoryCurrentTime(_ref55, _ref56) {\n        var historyCurrentTime = _ref55.payload.historyCurrentTime;\n        var put = _ref56.put;\n\n        if (_api) {\n          _api.historyCurrentTime = historyCurrentTime;\n        }\n      },\n      //注意，回调函数中用不了put，改用dispatch，如果使用dispatch就需要绑上namespace\n      init: /*#__PURE__*/_regenerator2.default.mark(function init(_ref57, _ref58) {\n        var payload = _ref57.payload,\n            initOverCallback = _ref57.initOverCallback;\n        var put = _ref58.put;\n\n        var dispatch, api, hlsjsEvents, config, autoplay, loadingLazyTime, errorMessageLazyTime, file, _config$preload, preload, muted, _payload, _outSideApi;\n\n        return _regenerator2.default.wrap(function init$(_context26) {\n          while (1) {\n            switch (_context26.prev = _context26.next) {\n              case 0:\n                _initPayload = payload;\n                dispatch = payload.dispatch, api = payload.api, hlsjsEvents = payload.hlsjsEvents, config = payload.config;\n                autoplay = config.autoplay, loadingLazyTime = config.showLoadingLazyTime, errorMessageLazyTime = config.showErrorMessageLazyTime, file = config.file, _config$preload = config.preload, preload = _config$preload === undefined ? true : _config$preload, muted = config.muted;\n\n                if (loadingLazyTime) {\n                  showLoadingLazyTime = loadingLazyTime;\n                }\n\n                if (errorMessageLazyTime) {\n                  showErrorMessageLazyTime = errorMessageLazyTime;\n                }\n\n                _api = api;\n                _dispatch = dispatch;\n                _config = config; //初始化loading状态\n\n                if (!autoplay) {\n                  _context26.next = 24;\n                  break;\n                }\n\n                _api.loadSource(file);\n\n                getTracks();\n                logger.info('Autoplay:', 'set the video to play automatically');\n                _api.autoplay = autoplay;\n                _api.notAutoPlayViewHide = true;\n\n                if (isReloading) {\n                  _context26.next = 17;\n                  break;\n                }\n\n                _context26.next = 17;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: true\n                  }\n                });\n\n              case 17:\n                _context26.next = 19;\n                return put({\n                  type: _playPause.namespace + '/playPauseSaga',\n                  payload: true\n                });\n\n              case 19:\n                _context26.next = 21;\n                return put({\n                  type: 'controlbar',\n                  payload: true\n                });\n\n              case 21:\n                //当autoplay=true初始化controlbar默认为显示\n                _api.trigger('controlbar', true);\n\n                _context26.next = 27;\n                break;\n\n              case 24:\n                if (preload) {\n                  _api.loadSource(file);\n\n                  getTracks();\n                }\n\n                _api.trigger('loading', false);\n\n                _api.loading = false;\n\n              case 27:\n                if (!muted) {\n                  _context26.next = 30;\n                  break;\n                }\n\n                _context26.next = 30;\n                return put({\n                  type: 'muted',\n                  payload: true,\n                  autoMuted: true\n                });\n\n              case 30:\n                if (!(_config.selection && isFirstPlay)) {\n                  _context26.next = 34;\n                  break;\n                }\n\n                _payload = (0, _extends3.default)({\n                  begin: 0,\n                  //5分钟\n                  end: 5 * 60\n                }, _config.selection);\n                _context26.next = 34;\n                return put({\n                  type: _selection.namespace + '/dataReducer',\n                  payload: _payload\n                });\n\n              case 34:\n                //防止事件没移除\n                _api.off(); //等待video运行起来后运行，对外提供接口\n\n\n                _outSideApi = (0, _outsideApi2.default)(payload, this.sagas);\n                initOverCallback && initOverCallback(_outSideApi); //----begin 事件处理\n                //需要再 initOverCallback之后执行\n\n                if (autoplay || isReloading) {\n                  //重连也需要运行\n                  //autoplay=flase时需要再手动播放后运行\n                  _videoEvents = (0, _events2.default)(payload, isFirstPlay, _state);\n                  isFirstPlay = false;\n                }\n\n                if (hlsjsEvents) {\n                  hlsjsEvents(payload);\n                } //----end 事件处理\n\n\n                isReloading = false;\n\n              case 40:\n              case 'end':\n                return _context26.stop();\n            }\n          }\n        }, init, this);\n      })\n    }\n  };\n};\n\nvar _loading = require('../loading');\n\nvar _end3 = require('../end');\n\nvar _playPause = require('../play-pause');\n\nvar _volume = require('../volume');\n\nvar _muted = require('../muted');\n\nvar _time = require('../time');\n\nvar _fullscreen = require('../fullscreen');\n\nvar _notAutoplay = require('../not-autoplay');\n\nvar _controlbar = require('../controlbar');\n\nvar _timeSlider = require('../time-slider');\n\nvar _errorMessage = require('../error-message');\n\nvar _track = require('../track');\n\nvar _fragment = require('../fragment');\n\nvar _selection = require('../selection');\n\nvar _living = require('../living');\n\nvar _playbackRate2 = require('../playback-rate');\n\nvar _pictureQuality = require('../picture-quality');\n\nvar _rotate = require('../rotate');\n\nvar _const = require('../../utils/const');\n\nvar _fullscreen2 = require('../../utils/dom/fullscreen');\n\nvar _fullscreen3 = _interopRequireDefault(_fullscreen2);\n\nvar _storage = require('../../utils/storage');\n\nvar storage = _interopRequireWildcard(_storage);\n\nvar _util = require('../../utils/util');\n\nvar util = _interopRequireWildcard(_util);\n\nvar _logger = require('../../utils/logger');\n\nvar logger = _interopRequireWildcard(_logger);\n\nvar _events = require('./events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _outsideApi = require('./outside-api');\n\nvar _outsideApi2 = _interopRequireDefault(_outsideApi);\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar namespace = exports.namespace = 'video'; //涉及api的功能只会也只能在次model进行处理\n//这个model的state不会在页面上用到，这个model是个指挥中心\n//触发各种状态然后通知各种model处理页面上的状态","map":{"version":3,"sources":["C:/Users/MaGent/Desktop/video/video/node_modules/html5-player/libs/model/video/index.js"],"names":["Object","defineProperty","exports","value","namespace","undefined","_regenerator","require","_regenerator2","_interopRequireDefault","_extends2","_extends3","default","_initPayload","_api","_dispatch","_config","_controlbarClearTimeout","fullscreenObj","loadingTimeout","showLoadingLazyTime","_const","SHOW_LOADING_LAZY_TIME","errorMessageTimeout","showErrorMessageLazyTime","SHOW_ERROR_MESSAGE_LAZY_TIME","_videoEvents","subtitleList","_state","retryReloadTime","lastCurrentTime","tempSeekingCurrentTime","isFirstPlay","isReloading","getTracks","_config2","tracks","i","forEach","v","k","kind","push","name","label","id","type","_track","payload","subtitleId","state","historyPercent","reducers","clear","_ref","reset","pause","off","detachMedia","sagas","loading","mark","_ref2","_ref3","put","wrap","loading$","_context","prev","next","isError","abrupt","clearTimeout","setTimeout","_loading","logger","info","trigger","message","stop","playAfterNotAutoplay","_ref4","_ref5","playAfterNotAutoplay$","_context2","playing","preload","loadSource","file","_events2","hideNotAutoPlayView","_ref6","_ref7","hideNotAutoPlayView$","_context3","_notAutoplay","notAutoPlayViewHide","play","_ref8","_ref9","play$","_context4","ended","currentTime","duration","_playPause","bufferTime","readyState","noControlbarAction","delayTime","controlbarHideTime","_ref10","_ref11","pause$","_context5","volume","_ref12","_ref13","_ref12$payload","realVideoVolume","volume$","_context6","isNaN","storage","set","MAX_VOLUME","setVolume","_volume","toFixed","muted","_ref14","_ref15","_ref14$payload","_ref14$autoMuted","autoMuted","muted$","_context7","_muted","end","_ref16","_ref17","end$","_context8","_end3","onControlbarEnter","replay","_ref18","_ref19","replay$","_context9","time","_ref20","_ref21","select","reduxStore","fragment","time$","_context10","living","sent","_time","videoGaps","data","_timeSlider","buffer","_ref22","_ref23","_ref22$payload","fragmentDuration","fragmentData","selection","selectionBeginPercent","sliderPercent","seeking","percent","position","gapPosition","fragment$","_context11","isHistory","begin","autoplay","gaps","gap","_fragment","seekingState","_ref24","_ref25","seekingState$","_context12","_ref26","_ref27","_ref26$payload","_ref26$payload$percen","seeking$","_context13","_ref28","_ref29","_ref28$payload","_begin","_end","_end2","selection$","_context14","minGap","maxGap","_selection","fullscreen","_ref30","_ref31","fullscreenDom","fullscreen$","_context15","remove","parentNode","_fullscreen3","ownerDocument","isFull","fullscreenElement","style","width","display","height","_fullscreen","supportsDomFullscreen","requestFullscreen","exitFullscreen","controlbarClearTimeout","_ref32","controlbar","_ref33","_ref34","flag","delayPromise","controlbar$","_context16","util","delay","controlbarShow","_controlbar","errorMessage","_ref35","_ref36","error","_errorMessage","reload","_ref37","_ref38","reload$","_context17","localization","reloading","_ref39","_ref40","living$","_context18","Infinity","_living","playbackRate","_ref41","_ref42","_playbackRate","playbackRate$","_context19","_playbackRate2","_ref43","_ref44","subtitleList$","_context20","switchSubtitle","_ref45","_ref46","switchSubtitle$","_context21","currentSubtitleTrack","hlsObj","subtitleTrack","textTracks","length","mode","hlsSubtitleCues","_ref47","_ref48","cues","hlsSubtitleCues$","_context22","startTime","endTime","text","pictureQualityList","_ref49","_ref50","pictureQualityList$","_context23","_pictureQuality","switchPictureQuality","_ref51","_ref52","switchPictureQuality$","_context24","nextLevel","currentQuality","rotate","_ref53","_ref54","rotate$","_context25","_rotate","clientWidth","clientHeight","transform","marginLeft","setHistoryCurrentTime","_ref55","_ref56","historyCurrentTime","init","_ref57","_ref58","initOverCallback","dispatch","api","hlsjsEvents","config","loadingLazyTime","errorMessageLazyTime","_config$preload","_payload","_outSideApi","init$","_context26","_outsideApi2","_fullscreen2","_storage","_interopRequireWildcard","_util","_logger","_events","_outsideApi","obj","__esModule","newObj","key","prototype","hasOwnProperty","call"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.namespace = undefined;\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nexports.default = function () {\n  //model支持方法，也支持纯对象，由于存在多个播放器，有作用域问题\n  //需要用到函数，函数返回的是纯对象，_api继承了整个video dom的对象，请参考src/api/api.js的说明。\n  var _initPayload = void 0;\n  var _api = void 0;\n  var _dispatch = void 0;\n  var _config = void 0;\n  //controlbar 隐藏定时器\n  var _controlbarClearTimeout = void 0;\n  var fullscreenObj = void 0;\n  var loadingTimeout = void 0;\n  var showLoadingLazyTime = _const.SHOW_LOADING_LAZY_TIME;\n  var errorMessageTimeout = void 0;\n  var showErrorMessageLazyTime = _const.SHOW_ERROR_MESSAGE_LAZY_TIME;\n  var _videoEvents = void 0;\n  var subtitleList = void 0;\n  //后续存放公共的一些state\n  var _state = {\n    retryReloadTime: 0,\n    lastCurrentTime: 0\n  };\n  var tempSeekingCurrentTime = void 0;\n  //视频第一次播放,autoplay=false是，需要手动播放才算第一次播放\n  //只要触发了play就算首次播放，不需要视频成功播放（重连是属于播放器播放异常，每个实例化的播放器只有一次首次播放，重连不会重新计算）\n  var isFirstPlay = true;\n  //是否是重连状态\n  //init函数运行完重置，不是根据dataloaded处理\n  var isReloading = false;\n  function getTracks() {\n    var _config2 = _config,\n        tracks = _config2.tracks;\n\n    subtitleList = [];\n    //字幕，缩略图等\n    if (tracks) {\n      var i = 0;\n      tracks.forEach(function (v, k) {\n        if (v.kind === 'subtitle') {\n          subtitleList.push((0, _extends3.default)({}, v, {\n            name: v.label,\n            id: i\n          }));\n          i++;\n        } else if (v.kind === 'thumbnail') {\n          _dispatch({\n            type: _track.namespace + '/thumbnailSaga',\n            payload: v\n          });\n        }\n      });\n      _dispatch({\n        type: namespace + '/subtitleList',\n        payload: {\n          subtitleList: subtitleList,\n          subtitleId: -1\n        }\n      });\n    }\n  }\n  return {\n    namespace: namespace,\n    state: {\n      historyPercent: 0\n    },\n    reducers: {\n      clear: function clear(state, _ref) {\n        var payload = _ref.payload;\n\n        _videoEvents && _videoEvents.reset();\n        if (_api) {\n          _api.pause();\n          //移除事件监控\n          _api.off();\n          _api.detachMedia && _api.detachMedia();\n          //重置\n          _api.reset();\n        }\n        //clear 正在setTimeout的定时器\n        _controlbarClearTimeout && _controlbarClearTimeout();\n        tempSeekingCurrentTime = undefined;\n        return this.state || {};\n      }\n    },\n    sagas: {\n      loading: /*#__PURE__*/_regenerator2.default.mark(function loading(_ref2, _ref3) {\n        var payload = _ref2.payload;\n        var put = _ref3.put;\n        var loading;\n        return _regenerator2.default.wrap(function loading$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                loading = payload.loading;\n\n                _api.loading = loading;\n\n                if (!(loading && _api.isError)) {\n                  _context.next = 4;\n                  break;\n                }\n\n                return _context.abrupt('return');\n\n              case 4:\n                clearTimeout(loadingTimeout);\n\n                if (!loading) {\n                  _context.next = 9;\n                  break;\n                }\n\n                loadingTimeout = setTimeout(function () {\n                  //使用setTimeout是为了防止视频很快就可以播放的情况，就不用展示loading。\n                  //否则就会对用户造成卡顿假像。\n                  _dispatch({\n                    type: _loading.namespace + '/setLoadingStateSaga',\n                    payload: payload\n                  });\n                  logger.info('Loading Video:', 'video is not enough to be played');\n                  _api.trigger('loading', loading);\n                }, showLoadingLazyTime);\n                _context.next = 13;\n                break;\n\n              case 9:\n                _context.next = 11;\n                return put({\n                  type: _loading.namespace + '/setLoadingStateSaga',\n                  payload: payload\n                });\n\n              case 11:\n                logger.info('Hide Loading:', 'video is enough to be played');\n                _api.trigger('loading', loading);\n\n              case 13:\n                if (!_api.isError) {\n                  _context.next = 16;\n                  break;\n                }\n\n                _context.next = 16;\n                return {\n                  type: namespace + '/errorMessage',\n                  payload: {\n                    message: null\n                  }\n                };\n\n              case 16:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, loading, this);\n      }),\n      playAfterNotAutoplay: /*#__PURE__*/_regenerator2.default.mark(function playAfterNotAutoplay(_ref4, _ref5) {\n        var payload = _ref4.payload;\n        var put = _ref5.put;\n        return _regenerator2.default.wrap(function playAfterNotAutoplay$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (_api.playing) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                if (!_config.preload) {\n                  //autoplay=false,preload=false\n                  _api.loadSource(_config.file);\n                  getTracks();\n                }\n                _context2.next = 4;\n                return put({\n                  type: 'controlbar',\n                  payload: true\n                });\n\n              case 4:\n                _context2.next = 6;\n                return put({\n                  type: 'play'\n                });\n\n              case 6:\n                //autoplay=flase时需要再手动播放后运行\n                _videoEvents = (0, _events2.default)(_initPayload, isFirstPlay, _state);\n                isFirstPlay = false;\n\n              case 8:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, playAfterNotAutoplay, this);\n      }),\n      hideNotAutoPlayView: /*#__PURE__*/_regenerator2.default.mark(function hideNotAutoPlayView(_ref6, _ref7) {\n        var payload = _ref6.payload;\n        var put = _ref7.put;\n        return _regenerator2.default.wrap(function hideNotAutoPlayView$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                logger.info('Hide Not Auto Play View');\n                _context3.next = 3;\n                return put({\n                  type: _notAutoplay.namespace + '/notAutoPlayStateSaga',\n                  payload: false\n                });\n\n              case 3:\n                _api.notAutoPlayViewHide = true;\n\n              case 4:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, hideNotAutoPlayView, this);\n      }),\n      play: /*#__PURE__*/_regenerator2.default.mark(function play(_ref8, _ref9) {\n        var payload = _ref8.payload;\n        var put = _ref9.put;\n        return _regenerator2.default.wrap(function play$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!_api.isError) {\n                  _context4.next = 2;\n                  break;\n                }\n\n                return _context4.abrupt('return');\n\n              case 2:\n                if (_api.notAutoPlayViewHide) {\n                  _context4.next = 5;\n                  break;\n                }\n\n                _context4.next = 5;\n                return put({\n                  type: 'hideNotAutoPlayView'\n                });\n\n              case 5:\n                if (!_api.ended) {\n                  _context4.next = 12;\n                  break;\n                }\n\n                //重新播放\n                //重置\n                _api.reset();\n                //如果已经播放结束，重新播放需要隐藏重新播放按钮\n                _context4.next = 9;\n                return put({\n                  type: 'end',\n                  payload: false\n                });\n\n              case 9:\n                _context4.next = 11;\n                return put({\n                  type: 'time',\n                  payload: {\n                    currentTime: 0,\n                    duration: _api.duration\n                  }\n                });\n\n              case 11:\n                _api.trigger('replay');\n\n              case 12:\n                _api.play();\n                logger.info('Play Action', 'start playing');\n                _context4.next = 16;\n                return put({\n                  type: _playPause.namespace + '/playPauseSaga',\n                  payload: true\n                });\n\n              case 16:\n                if (_api.bufferTime) {\n                  _context4.next = 21;\n                  break;\n                }\n\n                _context4.next = 19;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: true\n                  }\n                });\n\n              case 19:\n                _context4.next = 24;\n                break;\n\n              case 21:\n                if (!(!_api.loading && _api.bufferTime < _api.currentTime ||\n                //readyState < 3代表视频就绪状态不足以播放。\n                _api.readyState < 3)) {\n                  _context4.next = 24;\n                  break;\n                }\n\n                _context4.next = 24;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: true\n                  }\n                });\n\n              case 24:\n                if (!(!payload || payload && !payload.noControlbarAction)) {\n                  _context4.next = 29;\n                  break;\n                }\n\n                _context4.next = 27;\n                return put({\n                  type: 'controlbarClearTimeout'\n                });\n\n              case 27:\n                _context4.next = 29;\n                return put({\n                  type: 'controlbar',\n                  payload: false,\n                  delayTime: _config.controlbarHideTime\n                });\n\n              case 29:\n              case 'end':\n                return _context4.stop();\n            }\n          }\n        }, play, this);\n      }),\n      pause: /*#__PURE__*/_regenerator2.default.mark(function pause(_ref10, _ref11) {\n        var payload = _ref10.payload;\n        var put = _ref11.put;\n        return _regenerator2.default.wrap(function pause$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (!_api.isError) {\n                  _context5.next = 2;\n                  break;\n                }\n\n                return _context5.abrupt('return');\n\n              case 2:\n                logger.info('Pause Action', 'start pause');\n                _api.pause();\n\n                if (_api.playing) {\n                  _context5.next = 14;\n                  break;\n                }\n\n                _context5.next = 7;\n                return put({\n                  type: _playPause.namespace + '/playPauseSaga',\n                  payload: false\n                });\n\n              case 7:\n                if (!_api.loading) {\n                  _context5.next = 10;\n                  break;\n                }\n\n                _context5.next = 10;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: false\n                  }\n                });\n\n              case 10:\n                _context5.next = 12;\n                return put({\n                  type: 'controlbarClearTimeout'\n                });\n\n              case 12:\n                _context5.next = 14;\n                return put({\n                  type: 'controlbar',\n                  payload: true\n                });\n\n              case 14:\n              case 'end':\n                return _context5.stop();\n            }\n          }\n        }, pause, this);\n      }),\n      volume: /*#__PURE__*/_regenerator2.default.mark(function volume(_ref12, _ref13) {\n        var _ref12$payload = _ref12.payload,\n            payload = _ref12$payload === undefined ? 0 : _ref12$payload;\n        var put = _ref13.put;\n        var volume, realVideoVolume;\n        return _regenerator2.default.wrap(function volume$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                volume = payload;\n\n                if (isNaN(volume)) {\n                  //错误兼容处理\n                  volume = 0;\n                }\n                storage.set('volume', volume);\n                //转换成真实的video声音值，原生的video声音范围为[0,1]。\n                realVideoVolume = volume / _const.MAX_VOLUME * 1;\n\n                _api.setVolume(realVideoVolume);\n                _context6.next = 7;\n                return put({\n                  type: _volume.namespace + '/dataSaga',\n                  payload: payload\n                });\n\n              case 7:\n                _api.trigger('volume', volume);\n                logger.info('Set Volume', 'set volume to ' + volume.toFixed(2) + ',the max volume is 100.');\n\n              case 9:\n              case 'end':\n                return _context6.stop();\n            }\n          }\n        }, volume, this);\n      }),\n      muted: /*#__PURE__*/_regenerator2.default.mark(function muted(_ref14, _ref15) {\n        var _ref14$payload = _ref14.payload,\n            payload = _ref14$payload === undefined ? false : _ref14$payload,\n            _ref14$autoMuted = _ref14.autoMuted,\n            autoMuted = _ref14$autoMuted === undefined ? false : _ref14$autoMuted;\n        var put = _ref15.put;\n        var muted;\n        return _regenerator2.default.wrap(function muted$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                muted = payload;\n\n                if (!autoMuted) {\n                  storage.set('muted', muted);\n                }\n                _api.muted = muted;\n                _context7.next = 5;\n                return put({\n                  type: _muted.namespace + '/dataSaga',\n                  payload: payload\n                });\n\n              case 5:\n                if (!muted) {\n                  _context7.next = 8;\n                  break;\n                }\n\n                _context7.next = 8;\n                return put({\n                  type: _volume.namespace + '/dataSaga',\n                  payload: 0\n                });\n\n              case 8:\n                _api.trigger('muted', muted);\n                if (muted) {\n                  logger.info('Set Muted', 'set video muted ');\n                } else {\n                  logger.info('Cancel Muted', 'cancel video muted ');\n                }\n\n              case 10:\n              case 'end':\n                return _context7.stop();\n            }\n          }\n        }, muted, this);\n      }),\n      end: /*#__PURE__*/_regenerator2.default.mark(function end(_ref16, _ref17) {\n        var payload = _ref16.payload;\n        var put = _ref17.put;\n        return _regenerator2.default.wrap(function end$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _context8.next = 2;\n                return put({\n                  type: 'pause'\n                });\n\n              case 2:\n                if (!_api.loading) {\n                  _context8.next = 5;\n                  break;\n                }\n\n                _context8.next = 5;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: false\n                  }\n                });\n\n              case 5:\n                _context8.next = 7;\n                return put({\n                  type: _end3.namespace + '/endStateSaga',\n                  payload: payload\n                });\n\n              case 7:\n                _context8.next = 9;\n                return put({\n                  type: 'controlbar',\n                  payload: true,\n                  onControlbarEnter: false\n                });\n\n              case 9:\n                _context8.next = 11;\n                return put({\n                  type: 'time',\n                  payload: {\n                    currentTime: _api.ended ? _api.duration : _api.currentTime,\n                    duration: _api.duration\n                  }\n                });\n\n              case 11:\n              case 'end':\n                return _context8.stop();\n            }\n          }\n        }, end, this);\n      }),\n      replay: /*#__PURE__*/_regenerator2.default.mark(function replay(_ref18, _ref19) {\n        var payload = _ref18.payload;\n        var put = _ref19.put;\n        return _regenerator2.default.wrap(function replay$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.next = 2;\n                return put({\n                  type: 'time',\n                  payload: {\n                    currentTime: 0,\n                    duration: 0\n                  }\n                });\n\n              case 2:\n                _context9.next = 4;\n                return put({\n                  type: 'end',\n                  payload: false\n                });\n\n              case 4:\n                _context9.next = 6;\n                return put({\n                  type: 'play'\n                });\n\n              case 6:\n                logger.info('Replay', 'replay video when video is ended.');\n\n              case 7:\n              case 'end':\n                return _context9.stop();\n            }\n          }\n        }, replay, this);\n      }),\n      time: /*#__PURE__*/_regenerator2.default.mark(function time(_ref20, _ref21) {\n        var payload = _ref20.payload;\n        var put = _ref21.put,\n            select = _ref21.select;\n        var reduxStore, fragment;\n        return _regenerator2.default.wrap(function time$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                if (!(_api.isError && !_api.living)) {\n                  _context10.next = 5;\n                  break;\n                }\n\n                _context10.next = 3;\n                return put({\n                  type: 'errorMessage',\n                  payload: {\n                    message: null\n                  }\n                });\n\n              case 3:\n                _context10.next = 5;\n                return put({\n                  type: 'play'\n                });\n\n              case 5:\n                _context10.next = 7;\n                return select();\n\n              case 7:\n                reduxStore = _context10.sent;\n                fragment = reduxStore.fragment;\n                _context10.next = 11;\n                return put({\n                  type: _time.namespace + '/timeSaga',\n                  payload: (0, _extends3.default)({}, payload, {\n                    duration: fragment && fragment.duration || payload.duration,\n                    currentTime: payload.currentTime + (payload.currentTime === 0 ? 0 : _api.videoGaps)\n                  })\n                });\n\n              case 11:\n                if (!(!fragment || !fragment.data)) {\n                  _context10.next = 16;\n                  break;\n                }\n\n                _context10.next = 14;\n                return put({\n                  type: _timeSlider.namespace + '/timeSaga',\n                  payload: (0, _extends3.default)({\n                    buffer: _api.bufferTime\n                  }, payload)\n                });\n\n              case 14:\n                _context10.next = 18;\n                break;\n\n              case 16:\n                _context10.next = 18;\n                return put({\n                  type: 'fragment'\n                });\n\n              case 18:\n              case 'end':\n                return _context10.stop();\n            }\n          }\n        }, time, this);\n      }),\n\n      //合成录像，摄像头上传视频会中断，会分成几个视频，然后这几个视频会合并成一个视频\n      //但是这个视频不是整个时段的，会有断的，为了给用户知道这段录像哪里断了，需要而外处理\n      //这里是为了算出播放中，遇到断片的情况，进行一些跳过处理\n      fragment: /*#__PURE__*/_regenerator2.default.mark(function fragment(_ref22, _ref23) {\n        var _ref22$payload = _ref22.payload,\n            payload = _ref22$payload === undefined ? {} : _ref22$payload;\n        var put = _ref23.put,\n            select = _ref23.select;\n        var reduxStore, fragment, fragmentDuration, fragmentData, selection, selectionBeginPercent, sliderPercent, seeking, percent, position, gapPosition;\n        return _regenerator2.default.wrap(function fragment$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return select();\n\n              case 2:\n                reduxStore = _context11.sent;\n                fragment = reduxStore.fragment;\n\n                if (!(!fragment || !fragment.data)) {\n                  _context11.next = 6;\n                  break;\n                }\n\n                return _context11.abrupt('return');\n\n              case 6:\n                _api.fragmentDuration = fragment.duration;\n                if (_api.currentTime === 0) {\n                  //循环播放会重头放，需要重置\n                  _api.videoGaps = 0;\n                }\n                fragmentDuration = fragment.duration, fragmentData = fragment.data;\n                //begin----处理selection\n\n                selection = reduxStore.selection;\n                selectionBeginPercent = void 0;\n\n                if (!(_config.selection && !_config.isHistory)) {\n                  _context11.next = 18;\n                  break;\n                }\n\n                //history是fragment的另一版本，多个视频，fragment是一个视频\n                if (selection.end > fragment.duration) {\n                  selection.end = fragment.duration;\n                }\n\n                if (!(_api.currentTime + _api.videoGaps < selection.begin || _api.currentTime + _api.videoGaps > selection.end)) {\n                  _context11.next = 18;\n                  break;\n                }\n\n                if (!(_api.notAutoPlayViewHide && !_config.autoplay)) {\n                  _context11.next = 17;\n                  break;\n                }\n\n                _context11.next = 17;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: true\n                  }\n                });\n\n              case 17:\n                selectionBeginPercent = selection.begin / fragment.duration;\n\n              case 18:\n                //end----处理selection\n                sliderPercent = 0;\n                seeking = payload.seeking, percent = payload.percent;\n\n                if (seeking || selectionBeginPercent) {\n                  position = (selectionBeginPercent || percent) * fragmentDuration;\n                  //如果是点击、拖拽\n\n                  _api.videoGaps = 0;\n                  fragmentData.forEach(function (v) {\n                    if (position >= v.begin) {\n                      _api.videoGaps = v.gaps;\n                    }\n                    if (position >= v.begin && position < v.end) {\n                      position = v.begin + v.gap;\n                    }\n                  });\n                  sliderPercent = selectionBeginPercent || percent;\n                  tempSeekingCurrentTime = position - _api.videoGaps;\n                } else {\n                  gapPosition = _api.currentTime + _api.videoGaps;\n\n                  fragmentData.forEach(function (v, k) {\n                    if (gapPosition >= v.begin && gapPosition < v.end) {\n                      for (var i = 0; i <= k; i++) {\n                        _api.videoGaps = fragmentData[i].gaps;\n                      }\n                    }\n                  });\n                  sliderPercent = (_api.currentTime + _api.videoGaps) / fragmentDuration;\n                }\n                if (sliderPercent > 1 || _api.ended) {\n                  sliderPercent = 1;\n                }\n                _context11.next = 24;\n                return put({\n                  type: _fragment.namespace + '/sliderReducer',\n                  payload: {\n                    percent: sliderPercent\n                  }\n                });\n\n              case 24:\n              case 'end':\n                return _context11.stop();\n            }\n          }\n        }, fragment, this);\n      }),\n\n      //是否在seeking\n      seekingState: /*#__PURE__*/_regenerator2.default.mark(function seekingState(_ref24, _ref25) {\n        var payload = _ref24.payload;\n        var put = _ref25.put,\n            select = _ref25.select;\n        return _regenerator2.default.wrap(function seekingState$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                if (!_api.ended) {\n                  _context12.next = 2;\n                  break;\n                }\n\n                return _context12.abrupt('return');\n\n              case 2:\n                if (payload) {\n                  logger.info('Start seeking');\n                } else {\n                  logger.info('Stop seeking');\n                }\n                _api.seekingState = payload;\n                if (payload && _api.playing) {\n                  _api.pause();\n                }\n\n                if (payload) {\n                  _context12.next = 13;\n                  break;\n                }\n\n                if (tempSeekingCurrentTime !== undefined) {\n                  _api.currentTime = tempSeekingCurrentTime;\n                }\n                //seeking结束后，都播放视频。\n\n                if (_api.playing) {\n                  _context12.next = 12;\n                  break;\n                }\n\n                _context12.next = 10;\n                return put({ type: 'play' });\n\n              case 10:\n                _context12.next = 13;\n                break;\n\n              case 12:\n                _api.play();\n\n              case 13:\n              case 'end':\n                return _context12.stop();\n            }\n          }\n        }, seekingState, this);\n      }),\n      seeking: /*#__PURE__*/_regenerator2.default.mark(function seeking(_ref26, _ref27) {\n        var _ref26$payload = _ref26.payload,\n            _ref26$payload$percen = _ref26$payload.percent,\n            percent = _ref26$payload$percen === undefined ? 0 : _ref26$payload$percen,\n            pause = _ref26$payload.pause;\n        var put = _ref27.put,\n            select = _ref27.select;\n        var reduxStore, fragment;\n        return _regenerator2.default.wrap(function seeking$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                if (!(_api.readyState < 1 || isFirstPlay)) {\n                  _context13.next = 2;\n                  break;\n                }\n\n                return _context13.abrupt('return');\n\n              case 2:\n                if (!_api.ended) {\n                  _context13.next = 5;\n                  break;\n                }\n\n                _context13.next = 5;\n                return put({\n                  type: 'end',\n                  payload: false\n                });\n\n              case 5:\n                _context13.next = 7;\n                return select();\n\n              case 7:\n                reduxStore = _context13.sent;\n                fragment = reduxStore.fragment;\n\n                if (!(!fragment || !fragment.data)) {\n                  _context13.next = 15;\n                  break;\n                }\n\n                tempSeekingCurrentTime = _api.duration * percent;\n                _context13.next = 13;\n                return put({\n                  type: _timeSlider.namespace + '/timeSaga',\n                  payload: {\n                    buffer: _api.bufferTime,\n                    currentTime: _api.duration * percent,\n                    duration: _api.duration\n                  }\n                });\n\n              case 13:\n                _context13.next = 17;\n                break;\n\n              case 15:\n                _context13.next = 17;\n                return put({\n                  type: 'fragment',\n                  payload: {\n                    seeking: true,\n                    percent: percent\n                  }\n                });\n\n              case 17:\n                _api.trigger('seek', percent);\n\n              case 18:\n              case 'end':\n                return _context13.stop();\n            }\n          }\n        }, seeking, this);\n      }),\n      selection: /*#__PURE__*/_regenerator2.default.mark(function selection(_ref28, _ref29) {\n        var _ref28$payload = _ref28.payload,\n            percent = _ref28$payload.percent,\n            type = _ref28$payload.type,\n            duration = _ref28$payload.duration;\n        var put = _ref29.put,\n            select = _ref29.select;\n\n        var reduxStore, fragment, selection, begin, _begin, _end, _end2;\n\n        return _regenerator2.default.wrap(function selection$(_context14) {\n          while (1) {\n            switch (_context14.prev = _context14.next) {\n              case 0:\n                _context14.next = 2;\n                return select();\n\n              case 2:\n                reduxStore = _context14.sent;\n                fragment = reduxStore.fragment;\n                selection = reduxStore.selection;\n\n                if (!duration) {\n                  duration = fragment.duration;\n                }\n                if (selection.end > duration) {\n                  selection.end = duration;\n                }\n\n                if (!(type === 'left-blur')) {\n                  _context14.next = 15;\n                  break;\n                }\n\n                if (_config.isHistory) {\n                  _context14.next = 11;\n                  break;\n                }\n\n                _context14.next = 11;\n                return put({\n                  type: 'seeking',\n                  payload: {\n                    percent: percent\n                  }\n                });\n\n              case 11:\n                begin = percent * duration;\n                //对外提供selection事件\n\n                _api.trigger('selection', (0, _extends3.default)({}, selection, {\n                  begin: begin\n                }));\n                _context14.next = 32;\n                break;\n\n              case 15:\n                if (!(type === 'left-change')) {\n                  _context14.next = 23;\n                  break;\n                }\n\n                _begin = percent * duration;\n\n                if (_begin > selection.end - selection.minGap) {\n                  _begin = selection.end - selection.minGap;\n                  if (selection.end < selection.minGap) {\n                    _begin = 0;\n                  }\n                }\n                if (selection.end - _begin > selection.maxGap) {\n                  _begin = selection.end - selection.maxGap;\n                }\n                _context14.next = 21;\n                return put({\n                  type: _selection.namespace + '/dataReducer',\n                  payload: (0, _extends3.default)({}, selection, {\n                    begin: _begin\n                  })\n                });\n\n              case 21:\n                _context14.next = 32;\n                break;\n\n              case 23:\n                if (!(type === 'right-change')) {\n                  _context14.next = 31;\n                  break;\n                }\n\n                _end = percent * duration;\n\n                if (selection.begin > _end - selection.minGap) {\n                  _end = selection.begin + selection.minGap;\n                  if (selection.end < selection.minGap) {\n                    _end = duration;\n                  }\n                }\n                if (_end - selection.begin > selection.maxGap) {\n                  _end = selection.maxGap + selection.begin;\n                }\n                _context14.next = 29;\n                return put({\n                  type: _selection.namespace + '/dataReducer',\n                  payload: (0, _extends3.default)({}, selection, {\n                    end: _end\n                  })\n                });\n\n              case 29:\n                _context14.next = 32;\n                break;\n\n              case 31:\n                if (type === 'right-blur') {\n                  _end2 = percent * duration;\n                  //对外提供selection事件\n\n                  _api.trigger('selection', (0, _extends3.default)({}, selection, {\n                    end: _end2\n                  }));\n                }\n\n              case 32:\n              case 'end':\n                return _context14.stop();\n            }\n          }\n        }, selection, this);\n      }),\n      fullscreen: /*#__PURE__*/_regenerator2.default.mark(function fullscreen(_ref30, _ref31) {\n        var payload = _ref30.payload;\n        var put = _ref31.put;\n        var fullscreenDom;\n        return _regenerator2.default.wrap(function fullscreen$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                if (fullscreenObj) {\n                  fullscreenObj.remove();\n                }\n                fullscreenDom = _api.parentNode.parentNode;\n\n                fullscreenObj = new _fullscreen3.default(fullscreenDom, _api.ownerDocument, function () {\n                  var isFull = fullscreenObj.fullscreenElement();\n                  if (isFull) {\n                    fullscreenDom.style.width = '100%';\n                    fullscreenDom.style.display = 'block';\n                    fullscreenDom.style.height = '100%';\n                  } else {\n                    fullscreenDom.style.width = '';\n                    fullscreenDom.style.display = '';\n                    fullscreenDom.style.height = '';\n                  }\n                  _api.trigger('fullscreen', !!isFull);\n                  if (isFull) {\n                    logger.info('Fullscreen');\n                  } else {\n                    logger.info('Fullscreen exited');\n                  }\n                  _dispatch({\n                    type: _fullscreen.namespace + '/fullscreenSaga',\n                    payload: !!isFull\n                  });\n                  if (!isFull) {\n                    //非全屏，移除监听器。\n                    fullscreenObj.remove();\n                    fullscreenObj = null;\n                  }\n                });\n                if (fullscreenObj.supportsDomFullscreen) {\n                  if (payload) {\n                    fullscreenObj.requestFullscreen();\n                  } else {\n                    fullscreenObj.exitFullscreen();\n                  }\n                } else {\n                  //异常处理\n                }\n\n                if (!_api.playing) {\n                  _context15.next = 7;\n                  break;\n                }\n\n                _context15.next = 7;\n                return put({\n                  type: 'controlbar',\n                  payload: false,\n                  delayTime: _config.controlbarHideTime,\n                  onControlbarEnter: false\n                });\n\n              case 7:\n              case 'end':\n                return _context15.stop();\n            }\n          }\n        }, fullscreen, this);\n      }),\n      controlbarClearTimeout: function controlbarClearTimeout(_ref32) {\n        var payload = _ref32.payload;\n\n        if (payload && payload.onControlbarEnter !== undefined) {\n          _api.onControlbarEnter = payload.onControlbarEnter;\n        }\n        _controlbarClearTimeout && _controlbarClearTimeout();\n      },\n      controlbar: /*#__PURE__*/_regenerator2.default.mark(function controlbar(_ref33, _ref34) {\n        var payload = _ref33.payload,\n            delayTime = _ref33.delayTime,\n            onControlbarEnter = _ref33.onControlbarEnter;\n        var put = _ref34.put;\n        var flag, delayPromise;\n        return _regenerator2.default.wrap(function controlbar$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n                _context16.next = 2;\n                return put({\n                  type: 'controlbarClearTimeout'\n                });\n\n              case 2:\n                if (!(_api.isError && !payload)) {\n                  _context16.next = 4;\n                  break;\n                }\n\n                return _context16.abrupt('return');\n\n              case 4:\n                if (onControlbarEnter !== undefined) {\n                  _api.onControlbarEnter = onControlbarEnter;\n                }\n                if (_api.onControlbarEnter) {\n                  //如果正在controlbar上，强制controlbar显示\n                  payload = true;\n                }\n                flag = true;\n                //controlbar隐藏时，delay才有效，显示controlbar是立刻显示\n\n                if (!(delayTime && !payload)) {\n                  _context16.next = 13;\n                  break;\n                }\n\n                delayPromise = util.delay(delayTime);\n\n                _controlbarClearTimeout = delayPromise.clearTimeout;\n                _context16.next = 12;\n                return delayPromise;\n\n              case 12:\n                flag = _context16.sent;\n\n              case 13:\n                if (!flag) {\n                  _context16.next = 18;\n                  break;\n                }\n\n                if (payload) {\n                  _api.controlbarShow = true;\n                  logger.info('Controlbar show');\n                } else {\n                  _api.controlbarShow = false;\n                  logger.info('Controlbar hide');\n                }\n                _context16.next = 17;\n                return put({\n                  type: _controlbar.namespace + '/controlbarSaga',\n                  payload: payload\n                });\n\n              case 17:\n                //对外提供controlbar事件\n                _api.trigger('controlbar', payload);\n\n              case 18:\n              case 'end':\n                return _context16.stop();\n            }\n          }\n        }, controlbar, this);\n      }),\n      errorMessage: function errorMessage(_ref35, _ref36) {\n        var payload = _ref35.payload;\n        var put = _ref36.put;\n\n        clearTimeout(errorMessageTimeout);\n        if (_api.ended) {\n          return;\n        }\n        var error = function error() {\n          //先清除，可能遗留的\n          _dispatch({\n            type: namespace + '/controlbarClearTimeout'\n          });\n          if (!_api.controlbarShow) {\n            _dispatch({\n              type: namespace + '/controlbar',\n              payload: true,\n              onControlbarEnter: false\n            });\n          }\n          if (!_api.notAutoPlayViewHide) {\n            //如果not-autoplay页面没关闭\n            _dispatch({\n              type: namespace + '/hideNotAutoPlayView'\n            });\n          }\n          _dispatch({\n            type: _errorMessage.namespace + '/errorMessageSaga',\n            payload: payload\n          });\n          // 把播放暂停显示按钮显示为暂停。\n          _dispatch({\n            type: _playPause.namespace + '/playPauseSaga',\n            payload: false\n          });\n        };\n        if (payload.message) {\n          errorMessageTimeout = setTimeout(function () {\n            _api.isError = true;\n            //使用setTimeout是为了防止视频很快就可以播放的情况，就不用展示loading。\n            //否则就会对用户造成卡顿假像。\n            logger.info('Error message show');\n            if (_api.loading) {\n              //如果还有loading，需要隐藏\n              _dispatch({\n                type: namespace + '/loading',\n                payload: {\n                  loading: false\n                }\n              });\n            }\n            _dispatch({\n              type: namespace + '/pause'\n            });\n            error();\n          }, showErrorMessageLazyTime);\n        } else {\n          logger.info('Error message hide');\n          error();\n          //如果非错误，需要设置_api.isError为false\n          _api.isError = false;\n        }\n      },\n      reload: /*#__PURE__*/_regenerator2.default.mark(function reload(_ref37, _ref38) {\n        var payload = _ref37.payload;\n        var put = _ref38.put;\n        var retryReloadTime;\n        return _regenerator2.default.wrap(function reload$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n                logger.info('Reload Video');\n                //报错保存之前的播放进度\n                if (!_state.lastCurrentTime) {\n                  _state.lastCurrentTime = _api.currentTime;\n                }\n                retryReloadTime = 1;\n\n                if (payload) {\n                  retryReloadTime = payload.retryReloadTime;\n                }\n                isReloading = true;\n                _api.trigger('reload');\n                //重置\n                _api.reset();\n                _api.detachMedia && _api.detachMedia();\n                _videoEvents && _videoEvents.reset();\n                _context17.next = 11;\n                return put({\n                  type: 'errorMessage',\n                  payload: {\n                    message: null\n                  }\n                });\n\n              case 11:\n                _context17.next = 13;\n                return put({\n                  type: 'controlbar',\n                  payload: false\n                });\n\n              case 13:\n                _context17.next = 15;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: true,\n                    message: _config.localization.reloading,\n                    retryReloadTime: retryReloadTime,\n                    type: 'reload'\n                  }\n                });\n\n              case 15:\n                _config.reload(function () {\n                  _api.reloading = true;\n                  _api.isError = false;\n                });\n\n              case 16:\n              case 'end':\n                return _context17.stop();\n            }\n          }\n        }, reload, this);\n      }),\n      living: /*#__PURE__*/_regenerator2.default.mark(function living(_ref39, _ref40) {\n        var duration = _ref39.payload.duration;\n        var put = _ref40.put;\n        var living;\n        return _regenerator2.default.wrap(function living$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n                living = false;\n\n                if (duration === Infinity || isNaN(duration)) {\n                  living = true;\n                }\n                if (living) {\n                  logger.info('Living', 'the video is a living video.');\n                }\n                _api.living = living;\n                _context18.next = 6;\n                return put({\n                  type: _living.namespace + '/setLivingSaga',\n                  payload: living\n                });\n\n              case 6:\n              case 'end':\n                return _context18.stop();\n            }\n          }\n        }, living, this);\n      }),\n      playbackRate: /*#__PURE__*/_regenerator2.default.mark(function playbackRate(_ref41, _ref42) {\n        var _playbackRate = _ref41.payload;\n        var put = _ref42.put;\n        return _regenerator2.default.wrap(function playbackRate$(_context19) {\n          while (1) {\n            switch (_context19.prev = _context19.next) {\n              case 0:\n                logger.info('PlaybackRate switched');\n                _api.playbackRate = _playbackRate;\n                _context19.next = 4;\n                return put({\n                  type: _playbackRate2.namespace + '/setPlaybackRateSaga',\n                  payload: _playbackRate\n                });\n\n              case 4:\n              case 'end':\n                return _context19.stop();\n            }\n          }\n        }, playbackRate, this);\n      }),\n      subtitleList: /*#__PURE__*/_regenerator2.default.mark(function subtitleList(_ref43, _ref44) {\n        var payload = _ref43.payload;\n        var put = _ref44.put;\n        return _regenerator2.default.wrap(function subtitleList$(_context20) {\n          while (1) {\n            switch (_context20.prev = _context20.next) {\n              case 0:\n                logger.info('Subtitle List showed');\n                _context20.next = 3;\n                return put({\n                  type: _track.namespace + '/subtitleListSaga',\n                  payload: payload\n                });\n\n              case 3:\n              case 'end':\n                return _context20.stop();\n            }\n          }\n        }, subtitleList, this);\n      }),\n      switchSubtitle: /*#__PURE__*/_regenerator2.default.mark(function switchSubtitle(_ref45, _ref46) {\n        var payload = _ref45.payload;\n        var put = _ref46.put;\n        var i;\n        return _regenerator2.default.wrap(function switchSubtitle$(_context21) {\n          while (1) {\n            switch (_context21.prev = _context21.next) {\n              case 0:\n                //存储状态\n                _api.currentSubtitleTrack = payload;\n                //end----textTracks状态处理\n\n                if (!_api.hlsObj) {\n                  _context21.next = 5;\n                  break;\n                }\n\n                //hls.js解析的hls自带字幕\n                //hls.js切换方式就是这样。\n                _api.hlsObj.subtitleTrack = payload;\n                _context21.next = 17;\n                break;\n\n              case 5:\n                if (!(_api.textTracks.length > 0)) {\n                  _context21.next = 10;\n                  break;\n                }\n\n                //浏览器原生解析的hls自带字幕\n                //begin----textTracks状态处理\n                for (i = 0; i < _api.textTracks.length; i++) {\n                  _api.textTracks[i].mode = 'disabled';\n                }\n                if (_api.textTracks[payload]) {\n                  //关闭不用处理\n                  _api.textTracks[payload].mode = 'hidden';\n                }\n                _context21.next = 17;\n                break;\n\n              case 10:\n                if (!(subtitleList && subtitleList[payload])) {\n                  _context21.next = 15;\n                  break;\n                }\n\n                _context21.next = 13;\n                return put({\n                  type: _track.namespace + '/subtitleCuesSaga',\n                  payload: {\n                    subtitleId: payload,\n                    file: subtitleList[payload].file\n                  }\n                });\n\n              case 13:\n                _context21.next = 17;\n                break;\n\n              case 15:\n                _context21.next = 17;\n                return put({\n                  type: _track.namespace + '/subtitleCuesSaga',\n                  payload: {\n                    subtitleId: payload\n                  }\n                });\n\n              case 17:\n                _context21.next = 19;\n                return put({\n                  type: _track.namespace + '/subtitleListSaga',\n                  payload: {\n                    subtitleId: payload\n                  }\n                });\n\n              case 19:\n              case 'end':\n                return _context21.stop();\n            }\n          }\n        }, switchSubtitle, this);\n      }),\n      hlsSubtitleCues: /*#__PURE__*/_regenerator2.default.mark(function hlsSubtitleCues(_ref47, _ref48) {\n        var payload = _ref47.payload;\n        var put = _ref48.put;\n        var cues, k, v;\n        return _regenerator2.default.wrap(function hlsSubtitleCues$(_context22) {\n          while (1) {\n            switch (_context22.prev = _context22.next) {\n              case 0:\n                cues = [];\n\n                for (k = 0; k < payload.length; k++) {\n                  v = payload[k];\n\n                  cues.push({\n                    begin: v.startTime,\n                    end: v.endTime,\n                    text: v.text\n                  });\n                }\n                _context22.next = 4;\n                return put({\n                  type: _track.namespace + '/hlsSubtitleCuesSaga',\n                  payload: cues\n                });\n\n              case 4:\n              case 'end':\n                return _context22.stop();\n            }\n          }\n        }, hlsSubtitleCues, this);\n      }),\n      pictureQualityList: /*#__PURE__*/_regenerator2.default.mark(function pictureQualityList(_ref49, _ref50) {\n        var payload = _ref49.payload;\n        var put = _ref50.put;\n        return _regenerator2.default.wrap(function pictureQualityList$(_context23) {\n          while (1) {\n            switch (_context23.prev = _context23.next) {\n              case 0:\n                _context23.next = 2;\n                return put({\n                  type: _pictureQuality.namespace + '/dataSaga',\n                  payload: payload\n                });\n\n              case 2:\n              case 'end':\n                return _context23.stop();\n            }\n          }\n        }, pictureQualityList, this);\n      }),\n      switchPictureQuality: /*#__PURE__*/_regenerator2.default.mark(function switchPictureQuality(_ref51, _ref52) {\n        var payload = _ref51.payload;\n        var put = _ref52.put;\n        return _regenerator2.default.wrap(function switchPictureQuality$(_context24) {\n          while (1) {\n            switch (_context24.prev = _context24.next) {\n              case 0:\n                if (_api.hlsObj) {\n                  //hls.js切换画质\n                  _api.hlsObj.nextLevel = payload;\n                }\n                _context24.next = 3;\n                return put({\n                  type: _pictureQuality.namespace + '/dataSaga',\n                  payload: {\n                    currentQuality: payload\n                  }\n                });\n\n              case 3:\n              case 'end':\n                return _context24.stop();\n            }\n          }\n        }, switchPictureQuality, this);\n      }),\n      rotate: /*#__PURE__*/_regenerator2.default.mark(function rotate(_ref53, _ref54) {\n        var payload = _ref53.payload;\n        var put = _ref54.put;\n        var width, height;\n        return _regenerator2.default.wrap(function rotate$(_context25) {\n          while (1) {\n            switch (_context25.prev = _context25.next) {\n              case 0:\n                _context25.next = 2;\n                return put({\n                  type: _rotate.namespace + '/dataSaga',\n                  payload: payload\n                });\n\n              case 2:\n                width = _api.clientWidth;\n                height = _api.clientHeight;\n\n                _api.style.transform = 'rotate(-' + payload + 'deg)';\n                if (payload === 90 || payload === 270) {\n                  _api.style.width = height + 'px';\n                  _api.style.marginLeft = width / 2 - height / 2 + 'px';\n                } else {\n                  _api.style.width = '';\n                  _api.style.marginLeft = '';\n                }\n\n              case 6:\n              case 'end':\n                return _context25.stop();\n            }\n          }\n        }, rotate, this);\n      }),\n      setHistoryCurrentTime: function setHistoryCurrentTime(_ref55, _ref56) {\n        var historyCurrentTime = _ref55.payload.historyCurrentTime;\n        var put = _ref56.put;\n\n        if (_api) {\n          _api.historyCurrentTime = historyCurrentTime;\n        }\n      },\n\n      //注意，回调函数中用不了put，改用dispatch，如果使用dispatch就需要绑上namespace\n      init: /*#__PURE__*/_regenerator2.default.mark(function init(_ref57, _ref58) {\n        var payload = _ref57.payload,\n            initOverCallback = _ref57.initOverCallback;\n        var put = _ref58.put;\n\n        var dispatch, api, hlsjsEvents, config, autoplay, loadingLazyTime, errorMessageLazyTime, file, _config$preload, preload, muted, _payload, _outSideApi;\n\n        return _regenerator2.default.wrap(function init$(_context26) {\n          while (1) {\n            switch (_context26.prev = _context26.next) {\n              case 0:\n                _initPayload = payload;\n                dispatch = payload.dispatch, api = payload.api, hlsjsEvents = payload.hlsjsEvents, config = payload.config;\n                autoplay = config.autoplay, loadingLazyTime = config.showLoadingLazyTime, errorMessageLazyTime = config.showErrorMessageLazyTime, file = config.file, _config$preload = config.preload, preload = _config$preload === undefined ? true : _config$preload, muted = config.muted;\n\n\n                if (loadingLazyTime) {\n                  showLoadingLazyTime = loadingLazyTime;\n                }\n                if (errorMessageLazyTime) {\n                  showErrorMessageLazyTime = errorMessageLazyTime;\n                }\n                _api = api;\n                _dispatch = dispatch;\n                _config = config;\n                //初始化loading状态\n\n                if (!autoplay) {\n                  _context26.next = 24;\n                  break;\n                }\n\n                _api.loadSource(file);\n\n                getTracks();\n                logger.info('Autoplay:', 'set the video to play automatically');\n                _api.autoplay = autoplay;\n                _api.notAutoPlayViewHide = true;\n\n                if (isReloading) {\n                  _context26.next = 17;\n                  break;\n                }\n\n                _context26.next = 17;\n                return put({\n                  type: 'loading',\n                  payload: {\n                    loading: true\n                  }\n                });\n\n              case 17:\n                _context26.next = 19;\n                return put({\n                  type: _playPause.namespace + '/playPauseSaga',\n                  payload: true\n                });\n\n              case 19:\n                _context26.next = 21;\n                return put({\n                  type: 'controlbar',\n                  payload: true\n                });\n\n              case 21:\n                //当autoplay=true初始化controlbar默认为显示\n                _api.trigger('controlbar', true);\n                _context26.next = 27;\n                break;\n\n              case 24:\n                if (preload) {\n                  _api.loadSource(file);\n                  getTracks();\n                }\n                _api.trigger('loading', false);\n                _api.loading = false;\n\n              case 27:\n                if (!muted) {\n                  _context26.next = 30;\n                  break;\n                }\n\n                _context26.next = 30;\n                return put({\n                  type: 'muted',\n                  payload: true,\n                  autoMuted: true\n                });\n\n              case 30:\n                if (!(_config.selection && isFirstPlay)) {\n                  _context26.next = 34;\n                  break;\n                }\n\n                _payload = (0, _extends3.default)({\n                  begin: 0,\n                  //5分钟\n                  end: 5 * 60\n                }, _config.selection);\n                _context26.next = 34;\n                return put({\n                  type: _selection.namespace + '/dataReducer',\n                  payload: _payload\n                });\n\n              case 34:\n                //防止事件没移除\n                _api.off();\n                //等待video运行起来后运行，对外提供接口\n                _outSideApi = (0, _outsideApi2.default)(payload, this.sagas);\n\n                initOverCallback && initOverCallback(_outSideApi);\n                //----begin 事件处理\n                //需要再 initOverCallback之后执行\n                if (autoplay || isReloading) {\n                  //重连也需要运行\n                  //autoplay=flase时需要再手动播放后运行\n                  _videoEvents = (0, _events2.default)(payload, isFirstPlay, _state);\n                  isFirstPlay = false;\n                }\n                if (hlsjsEvents) {\n                  hlsjsEvents(payload);\n                }\n                //----end 事件处理\n                isReloading = false;\n\n              case 40:\n              case 'end':\n                return _context26.stop();\n            }\n          }\n        }, init, this);\n      })\n    }\n  };\n};\n\nvar _loading = require('../loading');\n\nvar _end3 = require('../end');\n\nvar _playPause = require('../play-pause');\n\nvar _volume = require('../volume');\n\nvar _muted = require('../muted');\n\nvar _time = require('../time');\n\nvar _fullscreen = require('../fullscreen');\n\nvar _notAutoplay = require('../not-autoplay');\n\nvar _controlbar = require('../controlbar');\n\nvar _timeSlider = require('../time-slider');\n\nvar _errorMessage = require('../error-message');\n\nvar _track = require('../track');\n\nvar _fragment = require('../fragment');\n\nvar _selection = require('../selection');\n\nvar _living = require('../living');\n\nvar _playbackRate2 = require('../playback-rate');\n\nvar _pictureQuality = require('../picture-quality');\n\nvar _rotate = require('../rotate');\n\nvar _const = require('../../utils/const');\n\nvar _fullscreen2 = require('../../utils/dom/fullscreen');\n\nvar _fullscreen3 = _interopRequireDefault(_fullscreen2);\n\nvar _storage = require('../../utils/storage');\n\nvar storage = _interopRequireWildcard(_storage);\n\nvar _util = require('../../utils/util');\n\nvar util = _interopRequireWildcard(_util);\n\nvar _logger = require('../../utils/logger');\n\nvar logger = _interopRequireWildcard(_logger);\n\nvar _events = require('./events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _outsideApi = require('./outside-api');\n\nvar _outsideApi2 = _interopRequireDefault(_outsideApi);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar namespace = exports.namespace = 'video'; //涉及api的功能只会也只能在次model进行处理\n//这个model的state不会在页面上用到，这个model是个指挥中心\n//触发各种状态然后通知各种model处理页面上的状态"]},"metadata":{},"sourceType":"script"}